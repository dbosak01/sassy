<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example 13: Mean Change From Baseline • sassy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example 13: Mean Change From Baseline">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sassy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/sassy.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sassy-listing.html">Example 1: Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-dm.html">Example 2: Demographics Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figure.html">Example 3: Figures</a>
    </li>
    <li>
      <a href="../articles/sassy-ae.html">Example 4: Adverse Events Table</a>
    </li>
    <li>
      <a href="../articles/sassy-vs.html">Example 5: Vital Signs Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figureby.html">Example 6: Figure with By Group</a>
    </li>
    <li>
      <a href="../articles/sassy-survival.html">Example 7: Survival Analysis</a>
    </li>
    <li>
      <a href="../articles/sassy-profile.html">Example 8: Patient Profile</a>
    </li>
    <li>
      <a href="../articles/sassy-forest.html">Example 9: Forest Plot</a>
    </li>
    <li>
      <a href="../articles/sassy-ds.html">Example 10: Disposition Table</a>
    </li>
    <li>
      <a href="../articles/sassy-plisting.html">Example 11: Subject Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-pfigure.html">Example 12: Combined Figure</a>
    </li>
    <li>
      <a href="../articles/sassy-chgbase.html">Example 13: Mean Change From Baseline</a>
    </li>
    <li>
      <a href="../articles/sassy-ae2.html">Example 14: AE Severity in Rows</a>
    </li>
    <li>
      <a href="../articles/sassy-intext.html">Example 15: Intext Table</a>
    </li>
    <li>
      <a href="../articles/sassy-shift.html">Example 16: Shift Table</a>
    </li>
    <li>
      <a href="../articles/sassy-disclaimers.html">Disclaimers</a>
    </li>
    <li>
      <a href="../articles/sassy-faq.html">Frequently Asked Questions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href=".././articles/sassy-faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/dbosak01/sassy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example 13: Mean Change From Baseline</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/sassy/blob/HEAD/vignettes/sassy-chgbase.Rmd" class="external-link"><code>vignettes/sassy-chgbase.Rmd</code></a></small>
      <div class="hidden name"><code>sassy-chgbase.Rmd</code></div>

    </div>

    
    
<p>The following example shows a Mean Change from Baseline chart for
Hematology Lab Values with supporting tables for the mean value and
number of patients. The figure is accomplished using the
<strong>ggplot</strong> and <strong>patchwork</strong> packages, and
data preparation that features the <strong>procs</strong> package.</p>
<div class="section level2">
<h2 id="program">Program<a class="anchor" aria-label="anchor" href="#program"></a>
</h2>
<p>Note the following about this example:</p>
<ul>
<li>The <strong><a href="https://procs.r-sassy.org" class="external-link">procs</a></strong>
package calculates mean values and confidence intervals for each
treatment group and visit.</li>
<li>The <strong><a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot2</a></strong>
package can create small tables in addition to charts.</li>
<li>The <strong><a href="https://CRAN.R-project.org/package=patchwork" class="external-link">patchwork</a></strong>
package can combine the ggplot chart and table into a single
image.<br>
</li>
<li>The patchwork images are dynamically added to a report object from
the <strong><a href="https://reporter.r-sassy.org" class="external-link">reporter</a></strong>
package. Titles are customized for each page.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-sassy.org" class="external-link">sassy</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"logr.notes"</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        <span class="st">"logr.autolog"</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        <span class="st">"procs.print"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get temp location for log and report output</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="fu">log_open</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example13.log"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get data ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Get data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get sample data path</span></span>
<span><span class="va">pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"sassy"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Open data library"</span><span class="op">)</span></span>
<span><span class="fu">libname</span><span class="op">(</span><span class="va">sdtm</span>, <span class="va">pth</span>, <span class="st">"csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create Formats ----------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create Formats"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Format for visits"</span><span class="op">)</span></span>
<span><span class="va">vfmt</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"DAY 1"</span>, <span class="st">"Day 1"</span><span class="op">)</span>, </span>
<span>              <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"WEEK 2"</span>, <span class="st">"Week 2"</span><span class="op">)</span>,</span>
<span>              <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"WEEK 4"</span>, <span class="st">"Week 4"</span><span class="op">)</span>,</span>
<span>              <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"WEEK 6"</span>, <span class="st">"Week 6"</span><span class="op">)</span>,</span>
<span>              <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"WEEK 12"</span>, <span class="st">"Week 12"</span><span class="op">)</span>,</span>
<span>              as.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Format for ARMs"</span><span class="op">)</span></span>
<span><span class="va">afmt</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM A"</span>, <span class="st">"Placebo"</span><span class="op">)</span>, </span>
<span>              <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM B"</span>, <span class="st">"Drug (10mg)"</span><span class="op">)</span>, </span>
<span>              <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM C"</span>, <span class="st">"Drug (20mg)"</span><span class="op">)</span>,</span>
<span>              <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM D"</span>, <span class="st">"Competitor"</span><span class="op">)</span>,</span>
<span>              as.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Prepare data ------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Prepare data"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Pull out needed visits and columns"</span><span class="op">)</span></span>
<span><span class="va">lbsub1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sdtm</span><span class="op">$</span><span class="va">LB</span>, <span class="va">VISIT</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">vfmt</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                <span class="fu">v</span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VISIT</span>, <span class="va">VISITNUM</span>, <span class="va">LBORRES</span>, <span class="va">LBCAT</span>, <span class="va">LBORRESU</span>, <span class="va">LBTEST</span>, </span>
<span>                  <span class="va">LBTESTCD</span>, <span class="va">LBBLFL</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Pull out baseline subset"</span><span class="op">)</span></span>
<span><span class="va">lbsub2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lbsub1</span>, <span class="va">LBBLFL</span> <span class="op">==</span> <span class="st">'Y'</span>, </span>
<span>                <span class="fu">v</span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VISIT</span>, <span class="va">LBORRES</span>, <span class="va">LBCAT</span>, <span class="va">LBTESTCD</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Merge and calculate change from baseline"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">lbsub1</span>, merge <span class="op">=</span> <span class="va">lbsub2</span>, merge_by <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">LBCAT</span>, <span class="va">LBTESTCD</span><span class="op">)</span>, </span>
<span>         rename <span class="op">=</span> <span class="fu">v</span><span class="op">(</span>LBORRES.1 <span class="op">=</span> <span class="va">LBORRES</span>, LBORRES.2 <span class="op">=</span> <span class="va">BLBORES</span>, VISIT.1 <span class="op">=</span> <span class="va">VISIT</span><span class="op">)</span>,</span>
<span>         drop <span class="op">=</span> <span class="va">VISIT.2</span>, <span class="op">{</span></span>
<span>            </span>
<span>           <span class="co"># Convert to double</span></span>
<span>           <span class="va">LBORRES.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="va">LBORRES.1</span><span class="op">)</span><span class="op">)</span></span>
<span>           </span>
<span>           <span class="co"># Convert to double</span></span>
<span>           <span class="va">LBORRES.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="va">LBORRES.2</span><span class="op">)</span><span class="op">)</span></span>
<span>          </span>
<span>           <span class="co"># Calculate Change from baseline  </span></span>
<span>           <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">LBORRES.1</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">LBORRES.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>             <span class="va">LBCHG</span> <span class="op">&lt;-</span> <span class="va">LBORRES.1</span> <span class="op">-</span> <span class="va">LBORRES.2</span></span>
<span>           <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>             <span class="va">LBCHG</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>           <span class="op">}</span></span>
<span></span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">lbsub</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Pull needed ARMs and columns for DM"</span><span class="op">)</span></span>
<span><span class="va">dmsub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sdtm</span><span class="op">$</span><span class="va">DM</span>, <span class="va">ARM</span> <span class="op">!=</span> <span class="st">"SCREEN FAILURE"</span>, <span class="fu">v</span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">ARMCD</span>, <span class="va">ARM</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Merge DM with LB to get subject treatments"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">lbsub</span>, merge <span class="op">=</span> <span class="va">dmsub</span>, merge_by <span class="op">=</span> <span class="va">USUBJID</span>, </span>
<span>         where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">VISIT</span><span class="op">)</span> <span class="op">!=</span> <span class="st">'SCREENING'</span><span class="op">)</span>, </span>
<span>         <span class="op">{</span></span>
<span>           <span class="va">VISIT</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">VISIT</span>, <span class="va">vfmt</span><span class="op">)</span></span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">lbdat</span> </span>
<span></span>
<span></span>
<span><span class="co"># Prepare lab test labels -------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Lab test labels"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get lookup data for lab tests"</span><span class="op">)</span></span>
<span><span class="fu">proc_sort</span><span class="op">(</span><span class="va">lbdat</span>, by <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">LBTESTCD</span>, <span class="va">LBTEST</span>, <span class="va">LBORRESU</span><span class="op">)</span>, </span>
<span>          keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">LBTESTCD</span>, <span class="va">LBTEST</span>, <span class="va">LBORRESU</span><span class="op">)</span>, </span>
<span>          options <span class="op">=</span> <span class="va">nodupkey</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tcodes</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create test label with units"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">tcodes</span>, where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">LBORRESU</span><span class="op">)</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>         keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">LBTESTCD</span>, <span class="va">LABEL</span><span class="op">)</span>, </span>
<span>         <span class="op">{</span></span>
<span>                      </span>
<span>           <span class="va">LABEL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">LBTEST</span>, <span class="st">" ("</span>, <span class="va">LBORRESU</span>, <span class="st">")"</span><span class="op">)</span> </span>
<span>           </span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tfmtdat</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create lab value lookup"</span><span class="op">)</span> </span>
<span><span class="va">tfmt</span> <span class="op">&lt;-</span> <span class="va">tfmtdat</span><span class="op">$</span><span class="va">LABEL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tfmt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">tfmtdat</span><span class="op">$</span><span class="va">LBTESTCD</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Apply superscripts as needed"</span><span class="op">)</span></span>
<span><span class="va">tfmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"(9)"</span>, <span class="fu">supsc</span><span class="op">(</span><span class="st">'9'</span><span class="op">)</span>, <span class="va">tfmt</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">tfmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"(12)"</span>, <span class="fu">supsc</span><span class="op">(</span><span class="st">'12'</span><span class="op">)</span>, <span class="va">tfmt</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co"># Calculate statistics ----------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Calculate statistics"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get statistics for change from baseline"</span><span class="op">)</span></span>
<span><span class="fu">proc_means</span><span class="op">(</span><span class="va">lbdat</span>, by <span class="op">=</span> <span class="va">LBTESTCD</span>, </span>
<span>           class <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">ARM</span>, <span class="va">VISIT</span><span class="op">)</span>, </span>
<span>           var <span class="op">=</span> <span class="va">LBCHG</span>,</span>
<span>           stats <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">std</span>, <span class="va">clm</span><span class="op">)</span>,</span>
<span>           options <span class="op">=</span> <span class="va">nway</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">datcl</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get statistics for mean lab value"</span><span class="op">)</span></span>
<span><span class="fu">proc_means</span><span class="op">(</span><span class="va">lbdat</span>, by <span class="op">=</span> <span class="va">LBTESTCD</span>, </span>
<span>           class <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">ARM</span>, <span class="va">VISIT</span><span class="op">)</span>, </span>
<span>           var <span class="op">=</span> <span class="va">LBORRES</span>,</span>
<span>           stats <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>           options <span class="op">=</span> <span class="va">nway</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">datmn</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Add mean lab values to change from baseline"</span><span class="op">)</span> </span>
<span><span class="va">datcl</span><span class="op">$</span><span class="va">MEANV</span> <span class="op">&lt;-</span> <span class="va">datmn</span><span class="op">$</span><span class="va">MEAN</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Apply formats"</span><span class="op">)</span></span>
<span><span class="va">datcl</span><span class="op">$</span><span class="va">BY</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">datcl</span><span class="op">$</span><span class="va">BY</span>, <span class="va">tfmt</span><span class="op">)</span></span>
<span><span class="va">datcl</span><span class="op">$</span><span class="va">CLASS1</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">datcl</span><span class="op">$</span><span class="va">CLASS1</span>, <span class="va">afmt</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create report -----------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create report"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create output path"</span><span class="op">)</span></span>
<span><span class="va">pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"output/example13.rtf"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create report first so content can be added dynamically"</span><span class="op">)</span></span>
<span><span class="va">rpt</span> <span class="op">&lt;-</span> <span class="fu">create_report</span><span class="op">(</span><span class="va">pth</span>, output_type <span class="op">=</span> <span class="st">"RTF"</span>,</span>
<span>                     font <span class="op">=</span> <span class="st">"Arial"</span>, font_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">page_header</span><span class="op">(</span><span class="st">"Sponsor: Archytas"</span>, right <span class="op">=</span> <span class="st">"Study: ABC"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">titles</span><span class="op">(</span><span class="st">"Figure 1.0"</span>, <span class="st">"Mean Change From Baseline (HEMATOLOGY)"</span>, <span class="st">"Safety Population"</span>,</span>
<span>         bold <span class="op">=</span> <span class="cn">TRUE</span>, blank_row <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">page_footer</span><span class="op">(</span><span class="st">"Date: "</span> <span class="op">%p%</span> <span class="fu">fapply</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%d%b%Y %H:%M:%S"</span><span class="op">)</span>, </span>
<span>              <span class="st">"Confidential"</span>, <span class="st">"Page [pg] of [tpg]"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Loop through lab tests"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">tst</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">datcl</span><span class="op">$</span><span class="va">BY</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"**** Lab Test: "</span> <span class="op">%p%</span> <span class="va">tst</span> <span class="op">%p%</span> <span class="st">" ****"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"Apply subset"</span><span class="op">)</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">datcl</span>, <span class="va">BY</span> <span class="op">==</span> <span class="va">tst</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"Create plot"</span><span class="op">)</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CLASS2</span>, y <span class="op">=</span> <span class="va">MEAN</span>, group <span class="op">=</span> <span class="va">CLASS1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">CLASS1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">CLASS1</span>, linetype <span class="op">=</span> <span class="va">CLASS1</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CLASS2</span>, ymin <span class="op">=</span> <span class="va">LCLM</span>, ymax <span class="op">=</span> <span class="va">UCLM</span>, color <span class="op">=</span> <span class="va">CLASS1</span><span class="op">)</span>,</span>
<span>                  position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_linetype.html" class="external-link">scale_linetype</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Treatment"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Visit'</span>, y <span class="op">=</span> <span class="st">'\n\nMean Change from Baseline (95% CI)'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"Create table for mean change/mean value"</span><span class="op">)</span></span>
<span>  <span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">CLASS1</span>, x <span class="op">=</span> <span class="va">CLASS2</span>, label <span class="op">=</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">MEAN</span>, <span class="va">MEANV</span>, <span class="st">"%4.2f"</span>, <span class="st">"%.2f"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, </span>
<span>                  hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">8</span> <span class="op">/</span> <span class="va">.pt</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mean Change from Baseline/Mean Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="va">rev</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>      plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span><span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"Create table for patient counts"</span><span class="op">)</span></span>
<span>  <span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">CLASS1</span>, x <span class="op">=</span> <span class="va">CLASS2</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, </span>
<span>                  hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">8</span> <span class="op">/</span> <span class="va">.pt</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Number of Patients"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="va">rev</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>      plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"Patch together plot and tables"</span><span class="op">)</span></span>
<span>  <span class="va">plts</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="va">t1</span> <span class="op">+</span> <span class="va">t2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                                    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"Create plot content"</span><span class="op">)</span></span>
<span>  <span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu">create_plot</span><span class="op">(</span><span class="va">plts</span>, height <span class="op">=</span> <span class="fl">6</span>, width <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">titles</span><span class="op">(</span><span class="st">"Laboratory Test: "</span> <span class="op">%p%</span> <span class="va">tst</span>, align <span class="op">=</span> <span class="st">"left"</span>, blank_row <span class="op">=</span> <span class="st">"below"</span><span class="op">)</span> </span>
<span>    </span>
<span>  <span class="fu">put</span><span class="op">(</span><span class="st">"Add content to report"</span><span class="op">)</span></span>
<span>  <span class="va">rpt</span> <span class="op">&lt;-</span> <span class="va">rpt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">add_content</span><span class="op">(</span><span class="va">plt1</span>, page_break <span class="op">=</span> <span class="cn">TRUE</span>, blank_row <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Write out report to file system"</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">write_report</span><span class="op">(</span><span class="va">rpt</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Clean Up ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Clean Up"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">log_close</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View report</span></span>
<span><span class="co"># file.show(res$modified_path)</span></span>
<span></span>
<span><span class="co"># View log</span></span>
<span><span class="co"># file.show(lf)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>Here is an image of the RTF report produced by the above example:</p>
<p><img src="../man/images/chgbase.png" align="center"></p>
</div>
<div class="section level2">
<h2 id="log">Log<a class="anchor" aria-label="anchor" href="#log"></a>
</h2>
<p>Here is the log produced by the above mean change from baseline
example:</p>
<pre><code>=========================================================================
Log Path: C:/Users/dbosa/AppData/Local/Temp/RtmpuCtffJ/log/example13.log
Program Path: C:/packages/Testing/sassytests/ControlChart.R
Working Directory: C:/packages/Testing
User Name: dbosa
R Version: 4.3.2 (2023-10-31 ucrt)
Machine: SOCRATES x86-64
Operating System: Windows 10 x64 build 22621
Base Packages: stats graphics grDevices utils datasets methods base Other
Packages: tidylog_1.0.2 patchwork_1.1.3 ggplot2_3.4.4 procs_1.0.5
reporter_1.4.4 libr_1.2.9 logr_1.3.5 fmtr_1.6.2 common_1.1.1 sassy_1.2.1
Log Start Time: 2024-02-02 22:44:16.986801
=========================================================================

=========================================================================
Get data
=========================================================================

Open data library

# library 'sdtm': 15 items
- attributes: csv not loaded
- path: ./data/abc/SDTM
- items:
      Name Extension  Rows Cols     Size        LastModified
1       AE       csv   150   27  88.3 Kb 2020-09-18 14:30:23
2       DA       csv  3587   18   528 Kb 2020-09-18 14:30:23
3       DM       csv    87   24  45.3 Kb 2020-09-18 14:30:23
4       DS       csv   174    9  33.9 Kb 2020-09-18 14:30:23
5  DS_IHOR       csv   174    9  33.9 Kb 2020-09-18 14:30:23
6       EX       csv    84   11  26.2 Kb 2020-09-18 14:30:23
7       IE       csv     2   14  13.2 Kb 2020-09-18 14:30:23
8       LB       csv  2069   12 211.2 Kb 2024-02-02 22:42:43
9      LB4       csv 23607   27   5.4 Mb 2020-09-18 14:30:23
10     LB6       csv  7810   12   879 Kb 2024-02-01 00:20:30
11      PE       csv  1854   17 275.7 Kb 2020-09-18 14:30:24
12      QS       csv 13316   17   1.7 Mb 2020-09-18 14:30:24
13  SUPPEX       csv   639   10  63.8 Kb 2020-09-18 14:30:24
14      SV       csv   685   10  70.1 Kb 2020-09-18 14:30:24
15      VS       csv  3358   17 467.2 Kb 2020-09-18 14:30:24

=========================================================================
Create Formats
=========================================================================

Format for visits

# A user-defined format: 5 conditions
- as.factor: TRUE
  Name Type     Expression   Label Order
1  obj    U   x == "DAY 1"   Day 1    NA
2  obj    U  x == "WEEK 2"  Week 2    NA
3  obj    U  x == "WEEK 4"  Week 4    NA
4  obj    U  x == "WEEK 6"  Week 6    NA
5  obj    U x == "WEEK 12" Week 12    NA

Format for ARMs

# A user-defined format: 4 conditions
- as.factor: TRUE
  Name Type   Expression       Label Order
1  obj    U x == "ARM A"     Placebo    NA
2  obj    U x == "ARM B" Drug (10mg)    NA
3  obj    U x == "ARM C" Drug (20mg)    NA
4  obj    U x == "ARM D"  Competitor    NA

=========================================================================
Prepare data
=========================================================================

Pull out needed visits and columns

# A tibble: 1,578 × 9
   USUBJID    VISIT   VISITNUM LBORRES LBCAT      LBORRESU LBTEST      LBTESTCD LBBLFL
   &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt; 
 1 ABC-01-049 DAY 1          1    0.04 HEMATOLOGY x10(9)/L Basophils   BASO     Y     
 2 ABC-01-049 WEEK 2         2    0.01 HEMATOLOGY x10(9)/L Basophils   BASO     &lt;NA&gt;  
 3 ABC-01-049 WEEK 6         6    0.06 HEMATOLOGY x10(9)/L Basophils   BASO     &lt;NA&gt;  
 4 ABC-01-049 WEEK 12       12    0.03 HEMATOLOGY x10(9)/L Basophils   BASO     &lt;NA&gt;  
 5 ABC-01-049 DAY 1          1    0.19 HEMATOLOGY x10(9)/L Eosinophils EOS      Y     
 6 ABC-01-049 WEEK 2         2    0.19 HEMATOLOGY x10(9)/L Eosinophils EOS      &lt;NA&gt;  
 7 ABC-01-049 WEEK 6         6    0.21 HEMATOLOGY x10(9)/L Eosinophils EOS      &lt;NA&gt;  
 8 ABC-01-049 WEEK 12       12    0.18 HEMATOLOGY x10(9)/L Eosinophils EOS      &lt;NA&gt;  
 9 ABC-01-049 DAY 1          1   42.6  HEMATOLOGY %        Hematocrit  HCT      Y     
10 ABC-01-049 WEEK 2         2   44.3  HEMATOLOGY %        Hematocrit  HCT      &lt;NA&gt;  
# ℹ 1,568 more rows
# ℹ Use `print(n = ...)` to see more rows

Pull out baseline subset

# A tibble: 409 × 5
   USUBJID    VISIT LBORRES LBCAT      LBTESTCD
   &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   
 1 ABC-01-049 DAY 1    0.04 HEMATOLOGY BASO    
 2 ABC-01-049 DAY 1    0.19 HEMATOLOGY EOS     
 3 ABC-01-049 DAY 1   42.6  HEMATOLOGY HCT     
 4 ABC-01-049 DAY 1   15    HEMATOLOGY HGB     
 5 ABC-01-049 DAY 1    1.91 HEMATOLOGY LYM     
 6 ABC-01-050 DAY 1    0.04 HEMATOLOGY BASO    
 7 ABC-01-050 DAY 1    0.33 HEMATOLOGY EOS     
 8 ABC-01-050 DAY 1   44.6  HEMATOLOGY HCT     
 9 ABC-01-050 DAY 1   15.7  HEMATOLOGY HGB     
10 ABC-01-050 DAY 1    1.23 HEMATOLOGY LYM     
# ℹ 399 more rows
# ℹ Use `print(n = ...)` to see more rows

Merge and calculate change from baseline

datastep: columns increased from 9 to 11

# A tibble: 1,578 × 11
   USUBJID    VISIT   VISITNUM LBORRES LBCAT   LBORRESU LBTEST LBTESTCD LBBLFL BLBORES
   &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt;
 1 ABC-01-049 WEEK 12       12    0.03 HEMATO… x10(9)/L Basop… BASO     &lt;NA&gt;      0.04
 2 ABC-01-049 WEEK 2         2    0.01 HEMATO… x10(9)/L Basop… BASO     &lt;NA&gt;      0.04
 3 ABC-01-049 DAY 1          1    0.04 HEMATO… x10(9)/L Basop… BASO     Y         0.04
 4 ABC-01-049 WEEK 6         6    0.06 HEMATO… x10(9)/L Basop… BASO     &lt;NA&gt;      0.04
 5 ABC-01-049 WEEK 12       12    0.18 HEMATO… x10(9)/L Eosin… EOS      &lt;NA&gt;      0.19
 6 ABC-01-049 DAY 1          1    0.19 HEMATO… x10(9)/L Eosin… EOS      Y         0.19
 7 ABC-01-049 WEEK 2         2    0.19 HEMATO… x10(9)/L Eosin… EOS      &lt;NA&gt;      0.19
 8 ABC-01-049 WEEK 6         6    0.21 HEMATO… x10(9)/L Eosin… EOS      &lt;NA&gt;      0.19
 9 ABC-01-049 WEEK 12       12   45.3  HEMATO… %        Hemat… HCT      &lt;NA&gt;     42.6 
10 ABC-01-049 WEEK 2         2   44.3  HEMATO… %        Hemat… HCT      &lt;NA&gt;     42.6 
# ℹ 1,568 more rows
# ℹ 1 more variable: LBCHG &lt;dbl&gt;
# ℹ Use `print(n = ...)` to see more rows

Pull needed ARMs and columns for DM

# A tibble: 85 × 3
   USUBJID    ARMCD ARM  
   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;
 1 ABC-01-049 4     ARM D
 2 ABC-01-050 2     ARM B
 3 ABC-01-051 1     ARM A
 4 ABC-01-052 3     ARM C
 5 ABC-01-053 2     ARM B
 6 ABC-01-054 4     ARM D
 7 ABC-01-055 3     ARM C
 8 ABC-01-056 1     ARM A
 9 ABC-01-113 4     ARM D
10 ABC-01-114 2     ARM B
# ℹ 75 more rows
# ℹ Use `print(n = ...)` to see more rows

Merge DM with LB to get subject treatments

datastep: columns increased from 11 to 13

# A tibble: 1,578 × 13
   USUBJID    VISIT   VISITNUM LBORRES LBCAT   LBORRESU LBTEST LBTESTCD LBBLFL BLBORES
   &lt;chr&gt;      &lt;ord&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt;
 1 ABC-01-049 Week 12       12    2.59 HEMATO… x10(9)/L Lymph… LYM      &lt;NA&gt;      1.91
 2 ABC-01-049 Week 6         6    2.35 HEMATO… x10(9)/L Lymph… LYM      &lt;NA&gt;      1.91
 3 ABC-01-049 Week 2         2    2.59 HEMATO… x10(9)/L Lymph… LYM      &lt;NA&gt;      1.91
 4 ABC-01-049 Week 6         6    0.06 HEMATO… x10(9)/L Basop… BASO     &lt;NA&gt;      0.04
 5 ABC-01-049 Week 12       12    0.18 HEMATO… x10(9)/L Eosin… EOS      &lt;NA&gt;      0.19
 6 ABC-01-049 Week 12       12   15.9  HEMATO… g/dL     Hemog… HGB      &lt;NA&gt;     15   
 7 ABC-01-049 Week 2         2    0.19 HEMATO… x10(9)/L Eosin… EOS      &lt;NA&gt;      0.19
 8 ABC-01-049 Week 6         6    0.21 HEMATO… x10(9)/L Eosin… EOS      &lt;NA&gt;      0.19
 9 ABC-01-049 Week 12       12   45.3  HEMATO… %        Hemat… HCT      &lt;NA&gt;     42.6 
10 ABC-01-049 Day 1          1    1.91 HEMATO… x10(9)/L Lymph… LYM      Y         1.91
# ℹ 1,568 more rows
# ℹ 3 more variables: LBCHG &lt;dbl&gt;, ARMCD &lt;chr&gt;, ARM &lt;chr&gt;
# ℹ Use `print(n = ...)` to see more rows

=========================================================================
Lab test labels
=========================================================================

Get lookup data for lab tests

proc_sort: input data set 10 rows and 13 columns
           by: LBTESTCD LBTEST LBORRESU
           keep: LBTESTCD LBTEST LBORRESU
           order: a a a
           options: nodupkey
           output data set 10 rows and 3 columns

# A tibble: 10 × 3
   LBTESTCD LBTEST      LBORRESU
   &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;   
 1 BASO     Basophils   x10(9)/L
 2 BASO     Basophils   &lt;NA&gt;    
 3 EOS      Eosinophils x10(9)/L
 4 EOS      Eosinophils &lt;NA&gt;    
 5 HCT      Hematocrit  %       
 6 HCT      Hematocrit  &lt;NA&gt;    
 7 HGB      Hemoglobin  g/dL    
 8 HGB      Hemoglobin  &lt;NA&gt;    
 9 LYM      Lymphocytes x10(9)/L
10 LYM      Lymphocytes &lt;NA&gt;    

Create test label with units

datastep: columns decreased from 3 to 2

# A tibble: 5 × 2
  LBTESTCD LABEL                 
  &lt;chr&gt;    &lt;chr&gt;                 
1 BASO     Basophils (x10(9)/L)  
2 EOS      Eosinophils (x10(9)/L)
3 HCT      Hematocrit (%)        
4 HGB      Hemoglobin (g/dL)     
5 LYM      Lymphocytes (x10(9)/L)

Create lab value lookup

Apply superscripts as needed

=========================================================================
Calculate statistics
=========================================================================

Get statistics for change from baseline

proc_means: input data set 1578 rows and 13 columns
            by: LBTESTCD
            class: ARM VISIT
            var: LBCHG
            stats: n mean std clm
            view: TRUE
            output: 1 datasets

   CLASS1  CLASS2   BY TYPE FREQ   VAR  N          MEAN        STD         LCLM
1   ARM A   Day 1 BASO    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
2   ARM A  Week 2 BASO    3   19 LBCHG 18 -5.555556e-03 0.04591837 -0.028390224
3   ARM A  Week 6 BASO    3   19 LBCHG 18 -3.888889e-03 0.04002042 -0.023790575
4   ARM A Week 12 BASO    3   18 LBCHG 17 -1.294118e-02 0.02365500 -0.025103453
5   ARM B   Day 1 BASO    3   20 LBCHG 20  0.000000e+00 0.00000000  0.000000000
6   ARM B  Week 2 BASO    3   20 LBCHG 19  7.894737e-03 0.02839776 -0.005792545
7   ARM B  Week 6 BASO    3   18 LBCHG 17 -4.117647e-03 0.04213947 -0.025783766
8   ARM B Week 12 BASO    3   18 LBCHG 15 -9.333333e-03 0.03514595 -0.028796514
9   ARM C   Day 1 BASO    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
10  ARM C  Week 2 BASO    3   18 LBCHG 17  1.352941e-02 0.02956797 -0.001673034
11  ARM C  Week 6 BASO    3   17 LBCHG 16  3.750000e-03 0.01995829 -0.006885022
12  ARM C Week 12 BASO    3   15 LBCHG 15  1.666667e-02 0.03885259 -0.004849181
13  ARM D   Day 1 BASO    3   25 LBCHG 21  0.000000e+00 0.00000000  0.000000000
14  ARM D  Week 2 BASO    3   22 LBCHG 20 -1.500000e-02 0.04489754 -0.036012697
15  ARM D  Week 6 BASO    3   19 LBCHG 18  3.333333e-03 0.04740315 -0.020239700
16  ARM D Week 12 BASO    3   20 LBCHG 18 -1.833333e-02 0.05136375 -0.043875928
17  ARM A   Day 1  EOS    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
18  ARM A  Week 2  EOS    3   19 LBCHG 18  8.888889e-03 0.09177267 -0.036748584
19  ARM A  Week 6  EOS    3   19 LBCHG 18 -5.555556e-04 0.11132740 -0.055917371
20  ARM A Week 12  EOS    3   18 LBCHG 17 -2.941176e-03 0.10263800 -0.055712766
21  ARM B   Day 1  EOS    3   20 LBCHG 20  0.000000e+00 0.00000000  0.000000000
22  ARM B  Week 2  EOS    3   20 LBCHG 19 -2.052632e-02 0.06875671 -0.053665990
23  ARM B  Week 6  EOS    3   18 LBCHG 17 -7.058824e-03 0.06687345 -0.041441981
24  ARM B Week 12  EOS    3   18 LBCHG 15 -2.333333e-02 0.05924123 -0.056140035
25  ARM C   Day 1  EOS    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
26  ARM C  Week 2  EOS    3   18 LBCHG 17 -3.470588e-02 0.06549023 -0.068377853
27  ARM C  Week 6  EOS    3   17 LBCHG 16 -2.875000e-02 0.07237633 -0.067316625
28  ARM C Week 12  EOS    3   15 LBCHG 15 -2.533333e-02 0.10020455 -0.080824765
29  ARM D   Day 1  EOS    3   25 LBCHG 21  0.000000e+00 0.00000000  0.000000000
30  ARM D  Week 2  EOS    3   22 LBCHG 20  4.000000e-03 0.09150209 -0.038824294
31  ARM D  Week 6  EOS    3   19 LBCHG 18 -1.388889e-02 0.09437964 -0.060822779
32  ARM D Week 12  EOS    3   20 LBCHG 18 -3.111111e-02 0.13437826 -0.097935847
33  ARM A   Day 1  HCT    3   20 LBCHG 20  0.000000e+00 0.00000000  0.000000000
34  ARM A  Week 2  HCT    3   20 LBCHG 20  3.400000e-01 1.67438913 -0.443638233
35  ARM A  Week 6  HCT    3   19 LBCHG 19  4.736842e-02 2.10353365 -0.966502342
36  ARM A Week 12  HCT    3   19 LBCHG 19 -1.473684e-01 2.20185993 -1.208630934
37  ARM B   Day 1  HCT    3   21 LBCHG 21  0.000000e+00 0.00000000  0.000000000
38  ARM B  Week 2  HCT    3   20 LBCHG 20  5.150000e-01 1.67905832 -0.270823483
39  ARM B  Week 6  HCT    3   18 LBCHG 18 -4.000000e-01 2.17147280 -1.479848018
40  ARM B Week 12  HCT    3   18 LBCHG 17 -1.941176e-01 1.86395768 -1.152476254
41  ARM C   Day 1  HCT    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
42  ARM C  Week 2  HCT    3   18 LBCHG 17 -8.823529e-02 1.87078939 -1.050106442
43  ARM C  Week 6  HCT    3   17 LBCHG 16 -3.000000e-01 1.78848167 -1.253014608
44  ARM C Week 12  HCT    3   16 LBCHG 15 -6.066667e-01 2.42147141 -1.947632839
45  ARM D   Day 1  HCT    3   23 LBCHG 21  0.000000e+00 0.00000000  0.000000000
46  ARM D  Week 2  HCT    3   22 LBCHG 20  1.900000e-01 1.74654546 -0.627408438
47  ARM D  Week 6  HCT    3   20 LBCHG 18  7.894799e-16 1.35559841 -0.674123232
48  ARM D Week 12  HCT    3   20 LBCHG 18 -5.833333e-01 1.52286495 -1.340636255
49  ARM A   Day 1  HGB    3   20 LBCHG 20  0.000000e+00 0.00000000  0.000000000
50  ARM A  Week 2  HGB    3   20 LBCHG 20  7.000000e-02 0.49957877 -0.163810061
51  ARM A  Week 6  HGB    3   19 LBCHG 19  2.105263e-02 0.63646502 -0.285713688
52  ARM A Week 12  HGB    3   19 LBCHG 19 -1.210526e-01 0.65453881 -0.436530239
53  ARM B   Day 1  HGB    3   21 LBCHG 21  0.000000e+00 0.00000000  0.000000000
54  ARM B  Week 2  HGB    3   20 LBCHG 20  1.300000e-01 0.56110793 -0.132606593
55  ARM B  Week 6  HGB    3   18 LBCHG 18 -8.333333e-02 0.74379789 -0.453215320
56  ARM B Week 12  HGB    3   18 LBCHG 17 -3.529412e-02 0.54651301 -0.316285179
57  ARM C   Day 1  HGB    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
58  ARM C  Week 2  HGB    3   18 LBCHG 17  0.000000e+00 0.65383484 -0.336170855
59  ARM C  Week 6  HGB    3   17 LBCHG 16 -8.750000e-02 0.61196405 -0.413592625
60  ARM C Week 12  HGB    3   16 LBCHG 15 -1.666667e-01 0.64438971 -0.523517792
61  ARM D   Day 1  HGB    3   23 LBCHG 21  0.000000e+00 0.00000000  0.000000000
62  ARM D  Week 2  HGB    3   22 LBCHG 20 -2.500000e-02 0.55995771 -0.287068273
63  ARM D  Week 6  HGB    3   20 LBCHG 18 -1.111111e-02 0.42962212 -0.224757164
64  ARM D Week 12  HGB    3   20 LBCHG 18 -2.000000e-01 0.51449576 -0.455852720
65  ARM A   Day 1  LYM    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
66  ARM A  Week 2  LYM    3   19 LBCHG 18  6.166667e-02 0.44072467 -0.157500556
67  ARM A  Week 6  LYM    3   19 LBCHG 18 -5.555556e-03 0.47330157 -0.240922891
68  ARM A Week 12  LYM    3   18 LBCHG 17 -3.529412e-03 0.42161803 -0.220305401
69  ARM B   Day 1  LYM    3   20 LBCHG 20  0.000000e+00 0.00000000  0.000000000
70  ARM B  Week 2  LYM    3   20 LBCHG 19  2.278947e-01 0.44226160  0.014731470
71  ARM B  Week 6  LYM    3   18 LBCHG 17  5.588235e-02 0.19624789 -0.045019003
72  ARM B Week 12  LYM    3   18 LBCHG 15  1.166667e-01 0.30513853 -0.052313420
73  ARM C   Day 1  LYM    3   19 LBCHG 19  0.000000e+00 0.00000000  0.000000000
74  ARM C  Week 2  LYM    3   18 LBCHG 17  6.117647e-02 0.25458010 -0.069716541
75  ARM C  Week 6  LYM    3   17 LBCHG 16 -3.062500e-02 0.29862951 -0.189753433
76  ARM C Week 12  LYM    3   15 LBCHG 15 -2.133333e-02 0.25939123 -0.164979408
77  ARM D   Day 1  LYM    3   25 LBCHG 21  0.000000e+00 0.00000000  0.000000000
78  ARM D  Week 2  LYM    3   22 LBCHG 20 -6.450000e-02 0.53546315 -0.315104470
79  ARM D  Week 6  LYM    3   19 LBCHG 18 -4.333333e-02 0.43414554 -0.259228833
80  ARM D Week 12  LYM    3   20 LBCHG 18 -1.461111e-01 0.41560925 -0.352788727
            UCLM
1   0.0000000000
2   0.0172791128
3   0.0160127976
4  -0.0007788999
5   0.0000000000
6   0.0215820188
7   0.0175484714
8   0.0101298474
9   0.0000000000
10  0.0287318579
11  0.0143850220
12  0.0381825143
13  0.0000000000
14  0.0060126975
15  0.0269063663
16  0.0072092609
17  0.0000000000
18  0.0545263620
19  0.0548062599
20  0.0498304131
21  0.0000000000
22  0.0126133584
23  0.0273243337
24  0.0094733686
25  0.0000000000
26 -0.0010339117
27  0.0098166246
28  0.0301580983
29  0.0000000000
30  0.0468242940
31  0.0330450016
32  0.0357136247
33  0.0000000000
34  1.1236382332
35  1.0612391846
36  0.9138940923
37  0.0000000000
38  1.3008234830
39  0.6798480184
40  0.7642409602
41  0.0000000000
42  0.8736358538
43  0.6530146081
44  0.7342995059
45  0.0000000000
46  1.0074084379
47  0.6741232315
48  0.1739695884
49  0.0000000000
50  0.3038100615
51  0.3278189507
52  0.1944249760
53  0.0000000000
54  0.3926065932
55  0.2865486531
56  0.2456969440
57  0.0000000000
58  0.3361708555
59  0.2385926247
60  0.1901844590
61  0.0000000000
62  0.2370682730
63  0.2025349414
64  0.0558527199
65  0.0000000000
66  0.2808338892
67  0.2298117794
68  0.2132465772
69  0.0000000000
70  0.4410580040
71  0.1567837086
72  0.2856467534
73  0.0000000000
74  0.1920694820
75  0.1285034325
76  0.1223127412
77  0.0000000000
78  0.1861044703
79  0.1725621663
80  0.0605665048

Get statistics for mean lab value

proc_means: input data set 1578 rows and 13 columns
            by: LBTESTCD
            class: ARM VISIT
            var: LBORRES
            stats: n mean
            view: TRUE
            output: 1 datasets

   CLASS1  CLASS2   BY TYPE FREQ     VAR  N        MEAN
1   ARM A   Day 1 BASO    3   19 LBORRES 19  0.03789474
2   ARM A  Week 2 BASO    3   19 LBORRES 19  0.03105263
3   ARM A  Week 6 BASO    3   19 LBORRES 19  0.03473684
4   ARM A Week 12 BASO    3   18 LBORRES 18  0.02666667
5   ARM B   Day 1 BASO    3   20 LBORRES 20  0.04100000
6   ARM B  Week 2 BASO    3   20 LBORRES 20  0.04800000
7   ARM B  Week 6 BASO    3   18 LBORRES 18  0.03333333
8   ARM B Week 12 BASO    3   18 LBORRES 16  0.03250000
9   ARM C   Day 1 BASO    3   19 LBORRES 19  0.02684211
10  ARM C  Week 2 BASO    3   18 LBORRES 18  0.03944444
11  ARM C  Week 6 BASO    3   17 LBORRES 17  0.03117647
12  ARM C Week 12 BASO    3   15 LBORRES 15  0.04466667
13  ARM D   Day 1 BASO    3   25 LBORRES 21  0.05333333
14  ARM D  Week 2 BASO    3   22 LBORRES 22  0.03863636
15  ARM D  Week 6 BASO    3   19 LBORRES 19  0.06210526
16  ARM D Week 12 BASO    3   20 LBORRES 20  0.03950000
17  ARM A   Day 1  EOS    3   19 LBORRES 19  0.15947368
18  ARM A  Week 2  EOS    3   19 LBORRES 19  0.16631579
19  ARM A  Week 6  EOS    3   19 LBORRES 19  0.16578947
20  ARM A Week 12  EOS    3   18 LBORRES 18  0.17722222
21  ARM B   Day 1  EOS    3   20 LBORRES 20  0.22000000
22  ARM B  Week 2  EOS    3   20 LBORRES 20  0.19600000
23  ARM B  Week 6  EOS    3   18 LBORRES 18  0.21722222
24  ARM B Week 12  EOS    3   18 LBORRES 16  0.20250000
25  ARM C   Day 1  EOS    3   19 LBORRES 19  0.20315789
26  ARM C  Week 2  EOS    3   18 LBORRES 18  0.17944444
27  ARM C  Week 6  EOS    3   17 LBORRES 17  0.18352941
28  ARM C Week 12  EOS    3   15 LBORRES 15  0.18800000
29  ARM D   Day 1  EOS    3   25 LBORRES 21  0.29095238
30  ARM D  Week 2  EOS    3   22 LBORRES 22  0.25681818
31  ARM D  Week 6  EOS    3   19 LBORRES 19  0.25894737
32  ARM D Week 12  EOS    3   20 LBORRES 20  0.25650000
33  ARM A   Day 1  HCT    3   20 LBORRES 20 41.84000000
34  ARM A  Week 2  HCT    3   20 LBORRES 20 42.18000000
35  ARM A  Week 6  HCT    3   19 LBORRES 19 42.46315789
36  ARM A Week 12  HCT    3   19 LBORRES 19 42.26842105
37  ARM B   Day 1  HCT    3   21 LBORRES 21 42.33809524
38  ARM B  Week 2  HCT    3   20 LBORRES 20 42.86500000
39  ARM B  Week 6  HCT    3   18 LBORRES 18 42.23888889
40  ARM B Week 12  HCT    3   18 LBORRES 17 42.48823529
41  ARM C   Day 1  HCT    3   19 LBORRES 19 42.48421053
42  ARM C  Week 2  HCT    3   18 LBORRES 18 42.50000000
43  ARM C  Week 6  HCT    3   17 LBORRES 17 42.28823529
44  ARM C Week 12  HCT    3   16 LBORRES 16 41.83750000
45  ARM D   Day 1  HCT    3   23 LBORRES 21 43.05714286
46  ARM D  Week 2  HCT    3   22 LBORRES 22 43.42727273
47  ARM D  Week 6  HCT    3   20 LBORRES 20 42.91000000
48  ARM D Week 12  HCT    3   20 LBORRES 20 42.69000000
49  ARM A   Day 1  HGB    3   20 LBORRES 20 14.45000000
50  ARM A  Week 2  HGB    3   20 LBORRES 20 14.52000000
51  ARM A  Week 6  HGB    3   19 LBORRES 19 14.65789474
52  ARM A Week 12  HGB    3   19 LBORRES 19 14.51578947
53  ARM B   Day 1  HGB    3   21 LBORRES 21 14.60000000
54  ARM B  Week 2  HGB    3   20 LBORRES 20 14.74500000
55  ARM B  Week 6  HGB    3   18 LBORRES 18 14.60000000
56  ARM B Week 12  HGB    3   18 LBORRES 17 14.71176471
57  ARM C   Day 1  HGB    3   19 LBORRES 19 14.54210526
58  ARM C  Week 2  HGB    3   18 LBORRES 18 14.58333333
59  ARM C  Week 6  HGB    3   17 LBORRES 17 14.50000000
60  ARM C Week 12  HGB    3   16 LBORRES 16 14.36250000
61  ARM D   Day 1  HGB    3   23 LBORRES 21 14.83333333
62  ARM D  Week 2  HGB    3   22 LBORRES 22 14.91363636
63  ARM D  Week 6  HGB    3   20 LBORRES 20 14.83000000
64  ARM D Week 12  HGB    3   20 LBORRES 20 14.75500000
65  ARM A   Day 1  LYM    3   19 LBORRES 19  1.94631579
66  ARM A  Week 2  LYM    3   19 LBORRES 19  2.00842105
67  ARM A  Week 6  LYM    3   19 LBORRES 19  1.90578947
68  ARM A Week 12  LYM    3   18 LBORRES 18  1.93611111
69  ARM B   Day 1  LYM    3   20 LBORRES 20  1.84700000
70  ARM B  Week 2  LYM    3   20 LBORRES 20  2.00600000
71  ARM B  Week 6  LYM    3   18 LBORRES 18  1.82333333
72  ARM B Week 12  LYM    3   18 LBORRES 16  1.89625000
73  ARM C   Day 1  LYM    3   19 LBORRES 19  1.77157895
74  ARM C  Week 2  LYM    3   18 LBORRES 18  1.88111111
75  ARM C  Week 6  LYM    3   17 LBORRES 17  1.80705882
76  ARM C Week 12  LYM    3   15 LBORRES 15  1.78666667
77  ARM D   Day 1  LYM    3   25 LBORRES 21  1.94476190
78  ARM D  Week 2  LYM    3   22 LBORRES 22  1.84318182
79  ARM D  Week 6  LYM    3   19 LBORRES 19  1.85000000
80  ARM D Week 12  LYM    3   20 LBORRES 20  1.77800000

Add mean lab values to change from baseline

Apply formats

=========================================================================
Create report
=========================================================================

Create output path

C:\Users\dbosa\AppData\Local\Temp\RtmpuCtffJ/output/example13.rtf

Create report first so content can be added dynamically

Loop through lab tests

**** Lab Test: Basophils (x10⁹/L) ****

Apply subset

Create plot

Create table for mean change/mean value

Create table for patient counts

Patch together plot and tables

Create plot content

Add content to report

**** Lab Test: Eosinophils (x10⁹/L) ****

Apply subset

Create plot

Create table for mean change/mean value

Create table for patient counts

Patch together plot and tables

Create plot content

Add content to report

**** Lab Test: Hematocrit (%) ****

Apply subset

Create plot

Create table for mean change/mean value

Create table for patient counts

Patch together plot and tables

Create plot content

Add content to report

**** Lab Test: Hemoglobin (g/dL) ****

Apply subset

Create plot

Create table for mean change/mean value

Create table for patient counts

Patch together plot and tables

Create plot content

Add content to report

**** Lab Test: Lymphocytes (x10⁹/L) ****

Apply subset

Create plot

Create table for mean change/mean value

Create table for patient counts

Patch together plot and tables

Create plot content

Add content to report

Write out report to file system

# A report specification: 5 pages
- file_path: 'C:\Users\dbosa\AppData\Local\Temp\RtmpuCtffJ/output/example13.rtf'
- output_type: RTF
- units: inches
- orientation: landscape
- margins: top 0.5 bottom 0.5 left 1 right 1
- line size/count: 9/42
- page_header: left=Sponsor: Archytas right=Study: ABC
- title 1: 'Figure 1.0'
- title 2: 'Mean Change From Baseline (HEMATOLOGY)'
- title 3: 'Safety Population'
- page_footer: left=Date: 02Feb2024 22:44:23 center=Confidential right=Page [pg] of [tpg]
- content: 
# A plot specification: 
- height: 6
- width: 9
- title 1: 'Laboratory Test: Basophils (x10⁹/L)'
# A plot specification: 
- height: 6
- width: 9
- title 1: 'Laboratory Test: Eosinophils (x10⁹/L)'
# A plot specification: 
- height: 6
- width: 9
- title 1: 'Laboratory Test: Hematocrit (%)'
# A plot specification: 
- height: 6
- width: 9
- title 1: 'Laboratory Test: Hemoglobin (g/dL)'
# A plot specification: 
- height: 6
- width: 9
- title 1: 'Laboratory Test: Lymphocytes (x10⁹/L)'

=========================================================================
Clean Up
=========================================================================

=========================================================================
Log End Time: 2024-02-02 22:44:32.173356
Log Elapsed Time: 0 00:00:15
=========================================================================

</code></pre>
<p>Next: <a href="sassy-ae2.html">Example 14: AE Severity in
Rows</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
