<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example 10: Disposition Table • sassy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example 10: Disposition Table">
<meta property="og:description" content="sassy">
<meta property="og:image" content="https://sassy.r-sassy.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sassy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/sassy.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sassy-listing.html">Example 1: Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-dm.html">Example 2: Demographics Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figure.html">Example 3: Figures</a>
    </li>
    <li>
      <a href="../articles/sassy-ae.html">Example 4: Adverse Events Table</a>
    </li>
    <li>
      <a href="../articles/sassy-vs.html">Example 5: Vital Signs Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figureby.html">Example 6: Figure with By Group</a>
    </li>
    <li>
      <a href="../articles/sassy-survival.html">Example 7: Survival Analysis</a>
    </li>
    <li>
      <a href="../articles/sassy-profile.html">Example 8: Patient Profile</a>
    </li>
    <li>
      <a href="../articles/sassy-forest.html">Example 9: Forest Plot</a>
    </li>
    <li>
      <a href="../articles/sassy-ds.html">Example 10: Disposition Table</a>
    </li>
    <li>
      <a href="../articles/sassy-plisting.html">Example 11: Subject Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-pfigure.html">Example 12: Combined Figure</a>
    </li>
    <li>
      <a href="../articles/sassy-disclaimers.html">Disclaimers</a>
    </li>
    <li>
      <a href="../articles/sassy-faq.html">Frequently Asked Questions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href=".././articles/sassy-faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/dbosak01/sassy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example 10: Disposition Table</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/sassy/blob/HEAD/vignettes/sassy-ds.Rmd" class="external-link"><code>vignettes/sassy-ds.Rmd</code></a></small>
      <div class="hidden name"><code>sassy-ds.Rmd</code></div>

    </div>

    
    
<p>This example produces a subject disposition table. The report
features extensive data preparation using the <strong>procs</strong>
package. The example also shows how to create a stub column with summary
rows.</p>
<div class="section level2">
<h2 id="program">Program<a class="anchor" aria-label="anchor" href="#program"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-sassy.org" class="external-link">sassy</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"logr.autolog"</span> <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        <span class="st">"logr.notes"</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        <span class="st">"logr.on"</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        <span class="st">"procs.print"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get temp directory</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Open log</span></span>
<span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="fu">log_open</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example10.log"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get data</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"sassy"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Load and Prepare Data ---------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Prepare Data"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Define data library"</span><span class="op">)</span></span>
<span><span class="fu">libname</span><span class="op">(</span><span class="va">sdtm</span>, <span class="va">dir</span>, <span class="st">"csv"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Prepare DM data"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">sdtm</span><span class="op">$</span><span class="va">DM</span>, keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">ARM</span><span class="op">)</span>, </span>
<span>         where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">ARM</span> <span class="op">!=</span> <span class="st">"SCREEN FAILURE"</span><span class="op">)</span>, <span class="op">{</span><span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">dm_mod</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Prepare DS data"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">sdtm</span><span class="op">$</span><span class="va">DS</span>, keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">DSTERM</span>, <span class="va">DSDECOD</span>, <span class="va">DSCAT</span><span class="op">)</span>, </span>
<span>         where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">DSCAT</span> <span class="op">!=</span> <span class="st">"PROTOCOL MILESTONE"</span><span class="op">)</span>, <span class="op">{</span><span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ds_mod</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Join DM with DS to get ARMs on DS"</span><span class="op">)</span> </span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">dm_mod</span>, merge <span class="op">=</span> <span class="va">ds_mod</span>, merge_by <span class="op">=</span> <span class="va">USUBJID</span>, <span class="op">{</span><span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">dmds</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Change ARM to factor to assist with sparse data"</span><span class="op">)</span></span>
<span><span class="va">dmds</span><span class="op">$</span><span class="va">ARM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dmds</span><span class="op">$</span><span class="va">ARM</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARM A"</span>, <span class="st">"ARM B"</span>, <span class="st">"ARM C"</span>, <span class="st">"ARM D"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get ARM population counts"</span><span class="op">)</span></span>
<span><span class="fu">proc_freq</span><span class="op">(</span><span class="va">dm_mod</span>, tables <span class="op">=</span> <span class="va">ARM</span>, output <span class="op">=</span> <span class="va">long</span>, </span>
<span>          options <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">nonobs</span>, <span class="va">nopercent</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">arm_pop</span></span>
<span></span>
<span><span class="co"># Prepare formats ---------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Completed Study</span></span>
<span><span class="va">complete_fmt</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"SUBJECT COMPLETED ALL VISITS AND PROTOCOL REQUIREMENTS"</span>,</span>
<span>                                <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="st">"SUBJECT COMPLETED ALL VISITS AND PROTOCOL REQUIREMENTS"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"SUBJECT COMPLETED ALL VISITS BUT WITH MAJOR PROTOCOL VIOLATIONS"</span>,</span>
<span>                                <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="st">"SUBJECT COMPLETED ALL VISITS BUT WITH MAJOR PROTOCOL VIOLATIONS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Subject Non-compliance</span></span>
<span><span class="va">noncomp_fmt</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"NON-COMPLIANCE WITH STUDY DRUG"</span>,</span>
<span>                               <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="st">"NON-COMPLIANCE WITH STUDY DRUG"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Early Termination</span></span>
<span><span class="va">term_fmt</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"LACK OF EFFICACY"</span>,</span>
<span>                            <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="st">"LACK OF EFFICACY"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu">condition</span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"LOST"</span><span class="op">)</span>,</span>
<span>                            <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="st">"LOST TO FOLLOW UP"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu">condition</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="st">"LACK OF EFFICACY"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group labels</span></span>
<span><span class="va">group_fmt</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"COMPLETED"</span>, <span class="st">"Subjects who Completed Study"</span><span class="op">)</span>,</span>
<span>                   <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"NONCOMPLIANCE"</span>, <span class="st">"Subjects terminated due to non-compliance"</span><span class="op">)</span>,</span>
<span>                   <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"OTHER"</span>, <span class="st">"Subjects who terminated early"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Disposition Groups ------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create vector of final dataframe columns"</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu">v</span><span class="op">(</span><span class="va">group</span>, <span class="va">cat</span>, <span class="va">catseq</span>, <span class="va">`ARM A`</span>, <span class="va">`ARM B`</span>, <span class="va">`ARM C`</span>, <span class="va">`ARM D`</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get group counts"</span><span class="op">)</span></span>
<span><span class="fu">proc_freq</span><span class="op">(</span><span class="va">dmds</span>, tables <span class="op">=</span> <span class="va">DSDECOD</span>, by <span class="op">=</span> <span class="va">ARM</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">BY</span>, <span class="va">CAT</span>, <span class="va">CNTPCT</span><span class="op">)</span>, <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fmt_cnt_pct</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">arm_pop</span><span class="op">[[</span><span class="va">BY</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>     </span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_transpose</span><span class="op">(</span>var <span class="op">=</span> <span class="va">CNTPCT</span>, by <span class="op">=</span> <span class="va">CAT</span>, id <span class="op">=</span> <span class="va">BY</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="va">cols</span>,</span>
<span>    <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CAT</span> <span class="op">==</span> <span class="st">"NON-COMPLIANCE WITH STUDY DRUG"</span>, <span class="st">"NONCOMPLIANCE"</span>, <span class="va">CAT</span><span class="op">)</span></span>
<span>    <span class="va">cat</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="va">catseq</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">grps</span></span>
<span></span>
<span></span>
<span><span class="co"># Disposition Subgroups ----------------------------------------------------</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Pull out subjects who completed study."</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">dmds</span>, where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">DSDECOD</span> <span class="op">==</span> <span class="st">"COMPLETED"</span><span class="op">)</span>,</span>
<span>         <span class="op">{</span></span>
<span>           <span class="va">TERMDECOD</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">DSTERM</span>, <span class="va">complete_fmt</span><span class="op">)</span></span>
<span>           </span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_freq</span><span class="op">(</span>tables <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">DSDECOD</span> <span class="op">*</span> <span class="va">TERMDECOD</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ARM</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">BY</span>, <span class="va">CAT1</span>, <span class="va">CAT2</span>, <span class="va">CNTPCT</span><span class="op">)</span>,</span>
<span>    <span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fmt_cnt_pct</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">arm_pop</span><span class="op">[[</span><span class="va">BY</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_transpose</span><span class="op">(</span>var <span class="op">=</span> <span class="va">CNTPCT</span>, by <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">CAT1</span>, <span class="va">CAT2</span><span class="op">)</span>, id <span class="op">=</span> <span class="va">BY</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="va">cols</span>,</span>
<span>    <span class="op">{</span></span>
<span>      <span class="va">group</span> <span class="op">=</span> <span class="va">CAT1</span></span>
<span>      <span class="va">cat</span> <span class="op">=</span> <span class="va">CAT2</span></span>
<span>      <span class="va">catseq</span> <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">cmplt</span></span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Pull out subjects who were non-compliant"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">dmds</span>, where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">DSDECOD</span> <span class="op">==</span> <span class="st">"NON-COMPLIANCE WITH STUDY DRUG"</span><span class="op">)</span>,</span>
<span>         <span class="op">{</span></span>
<span>           <span class="va">TERMDECOD</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">DSTERM</span>, <span class="va">noncomp_fmt</span><span class="op">)</span></span>
<span>           </span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_freq</span><span class="op">(</span>tables <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">DSDECOD</span> <span class="op">*</span> <span class="va">TERMDECOD</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ARM</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">BY</span>, <span class="va">CAT1</span>, <span class="va">CAT2</span>, <span class="va">CNTPCT</span><span class="op">)</span>,</span>
<span>           <span class="op">{</span></span>
<span>             </span>
<span>             <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fmt_cnt_pct</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">arm_pop</span><span class="op">[[</span><span class="va">BY</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>             </span>
<span>           <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_transpose</span><span class="op">(</span>var <span class="op">=</span> <span class="va">CNTPCT</span>, by <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">CAT1</span>, <span class="va">CAT2</span><span class="op">)</span>, id <span class="op">=</span> <span class="va">BY</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="va">cols</span>,</span>
<span>           <span class="op">{</span></span>
<span>             <span class="va">group</span> <span class="op">=</span> <span class="st">"NONCOMPLIANCE"</span></span>
<span>             <span class="va">cat</span> <span class="op">=</span> <span class="va">CAT2</span></span>
<span>             <span class="va">catseq</span> <span class="op">=</span> <span class="fl">2</span></span>
<span>           <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">noncompl</span></span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Pull out subjects who terminated early"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">dmds</span>, where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">DSDECOD</span> <span class="op">==</span> <span class="st">"OTHER"</span><span class="op">)</span>,</span>
<span>         <span class="op">{</span></span>
<span>           <span class="va">TERMDECOD</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">DSTERM</span>, <span class="va">term_fmt</span><span class="op">)</span></span>
<span>           </span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_freq</span><span class="op">(</span>tables <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">DSDECOD</span> <span class="op">*</span> <span class="va">TERMDECOD</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ARM</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">BY</span>, <span class="va">CAT1</span>, <span class="va">CAT2</span>, <span class="va">CNTPCT</span><span class="op">)</span>,</span>
<span>           <span class="op">{</span></span>
<span>             </span>
<span>             <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fmt_cnt_pct</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">arm_pop</span><span class="op">[[</span><span class="va">BY</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>             </span>
<span>           <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_transpose</span><span class="op">(</span>var <span class="op">=</span> <span class="va">CNTPCT</span>, by <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">CAT1</span>, <span class="va">CAT2</span><span class="op">)</span>, id <span class="op">=</span> <span class="va">BY</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span>keep <span class="op">=</span> <span class="va">cols</span>,</span>
<span>           <span class="op">{</span></span>
<span>             <span class="va">group</span> <span class="op">=</span> <span class="st">"OTHER"</span></span>
<span>             <span class="va">cat</span> <span class="op">=</span> <span class="va">CAT2</span></span>
<span>             <span class="va">catseq</span> <span class="op">=</span> <span class="fl">2</span></span>
<span>           <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">earlyterm</span></span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Combine blocks into final data frame"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">grps</span>, set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cmplt</span>, <span class="va">noncompl</span>, <span class="va">earlyterm</span><span class="op">)</span>, </span>
<span>    <span class="op">{</span></span>
<span>      <span class="va">lblind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">proc_sort</span><span class="op">(</span>by <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">group</span>, <span class="va">catseq</span>, <span class="va">cat</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">final</span></span>
<span></span>
<span></span>
<span><span class="co"># Report ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create and print report"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create Table</span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu">create_table</span><span class="op">(</span><span class="va">final</span>, first_row_blank <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    borders <span class="op">=</span> <span class="st">"all"</span>, width <span class="op">=</span> <span class="fl">8.5</span>, header_bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">column_defaults</span><span class="op">(</span>from <span class="op">=</span> <span class="va">`ARM A`</span>, to <span class="op">=</span> <span class="va">`ARM D`</span>, </span>
<span>                  align <span class="op">=</span> <span class="st">"center"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stub</span><span class="op">(</span>vars <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">group</span>, <span class="va">cat</span><span class="op">)</span>, <span class="st">"Completion Status"</span>, </span>
<span>       style <span class="op">=</span> <span class="fu">cell_style</span><span class="op">(</span>bold <span class="op">=</span> <span class="cn">TRUE</span>, indicator <span class="op">=</span> <span class="st">"lblind"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">group</span>, blank_after <span class="op">=</span> <span class="cn">TRUE</span>, dedupe <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         format <span class="op">=</span> <span class="va">group_fmt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">cat</span>, indent <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">catseq</span>, visible <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM A`</span>, label <span class="op">=</span> <span class="st">"Placebo"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM A"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM B`</span>, label <span class="op">=</span> <span class="st">"Drug 50mg"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM B"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM C`</span>, label <span class="op">=</span> <span class="st">"Drug 100mg"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM C"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM D`</span>, label <span class="op">=</span> <span class="st">"Competitor"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM D"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">lblind</span>, visible <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">titles</span><span class="op">(</span><span class="st">"Table 5.2.3"</span>, <span class="st">"Subject Disposition by Category and Treatment Group"</span>,                                                                      </span>
<span>         <span class="st">"Safety Population"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, font_size <span class="op">=</span> <span class="fl">11</span>,</span>
<span>         borders <span class="op">=</span> <span class="st">"outside"</span>, blank_row <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">footnotes</span><span class="op">(</span><span class="st">"Program: DS_Table.R"</span>,</span>
<span>            <span class="st">"NOTE: Denominator based on number of non-missing responses."</span>,</span>
<span>            borders <span class="op">=</span> <span class="st">"outside"</span>, blank_row <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example10.pdf"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rpt</span> <span class="op">&lt;-</span> <span class="fu">create_report</span><span class="op">(</span><span class="va">pth</span>, output_type <span class="op">=</span> <span class="st">"PDF"</span>, font <span class="op">=</span> <span class="st">"Arial"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">set_margins</span><span class="op">(</span>top <span class="op">=</span> <span class="fl">1</span>, bottom <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">add_content</span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="fu">write_report</span><span class="op">(</span><span class="va">rpt</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Clean Up ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Close log</span></span>
<span><span class="fu">log_close</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Uncomment to view files</span></span>
<span><span class="co"># file.show(pth)</span></span>
<span><span class="co"># file.show(lf)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>Here is the output report:</p>
<p><img src="../man/images/disposition.png" align="center"></p>
</div>
<div class="section level2">
<h2 id="log">Log<a class="anchor" aria-label="anchor" href="#log"></a>
</h2>
<p>Here is the log:</p>
<pre><code>=========================================================================
Log Path: C:/Users/dbosa/AppData/Local/Temp/RtmpEBPgPu/log/example10.log
Program Path: C:/packages/Testing/procs/ProcsDisposition.R
Working Directory: C:/packages/Testing/procs
User Name: dbosa
R Version: 4.3.1 (2023-06-16 ucrt)
Machine: SOCRATES x86-64
Operating System: Windows 10 x64 build 22621
Base Packages: stats graphics grDevices utils datasets methods base Other
Packages: tidylog_1.0.2 stringr_1.5.0 procs_1.0.3 reporter_1.4.1 libr_1.2.8
fmtr_1.5.9 logr_1.3.4 common_1.0.8 sassy_1.1.0
Log Start Time: 2023-09-05 22:06:05.090672
=========================================================================

=========================================================================
Prepare Data
=========================================================================

Define data library

# library 'sdtm': 7 items
- attributes: csv not loaded
- path: C:/Users/dbosa/AppData/Local/R/win-library/4.3/sassy/extdata
- items:
  Name Extension Rows Cols     Size
1   AE       csv  150   27  88.5 Kb
2   DM       csv   87   24  45.5 Kb
3   DS       csv  174    9  34.1 Kb
4   EX       csv   84   11  26.4 Kb
5   IE       csv    2   14  13.4 Kb
6   SV       csv  685   10  70.3 Kb
7   VS       csv 3358   17 467.4 Kb
         LastModified
1 2023-08-07 17:51:40
2 2023-08-07 17:51:40
3 2023-08-07 17:51:40
4 2023-08-07 17:51:40
5 2023-08-07 17:51:40
6 2023-08-07 17:51:40
7 2023-08-07 17:51:40

Prepare DM data

datastep: columns decreased from 24 to 2

# A tibble: 85 × 2
   USUBJID    ARM  
   &lt;chr&gt;      &lt;chr&gt;
 1 ABC-01-049 ARM D
 2 ABC-01-050 ARM B
 3 ABC-01-051 ARM A
 4 ABC-01-052 ARM C
 5 ABC-01-053 ARM B
 6 ABC-01-054 ARM D
 7 ABC-01-055 ARM C
 8 ABC-01-056 ARM A
 9 ABC-01-113 ARM D
10 ABC-01-114 ARM B
# ℹ 75 more rows
# ℹ Use `print(n = ...)` to see more rows

Prepare DS data

datastep: columns decreased from 9 to 4

# A tibble: 87 × 4
   USUBJID    DSTERM                  DSDECOD DSCAT
   &lt;chr&gt;      &lt;chr&gt;                   &lt;chr&gt;   &lt;chr&gt;
 1 ABC-01-049 SUBJECT COMPLETED ALL … COMPLE… DISP…
 2 ABC-01-050 SUBJECT COMPLETED ALL … COMPLE… DISP…
 3 ABC-01-051 SUBJECT COMPLETED ALL … COMPLE… DISP…
 4 ABC-01-052 SUBJECT COMPLETED ALL … COMPLE… DISP…
 5 ABC-01-053 NON-COMPLIANCE WITH ST… NON-CO… DISP…
 6 ABC-01-054 SUBJECT COMPLETED ALL … COMPLE… DISP…
 7 ABC-01-055 SUBJECT COMPLETED ALL … COMPLE… DISP…
 8 ABC-01-056 SUBJECT COMPLETED ALL … COMPLE… DISP…
 9 ABC-01-113 SUBJECT COMPLETED ALL … COMPLE… DISP…
10 ABC-01-114 SUBJECT COMPLETED ALL … COMPLE… DISP…
# ℹ 77 more rows
# ℹ Use `print(n = ...)` to see more rows

Join DM with DS to get ARMs on DS

datastep: columns increased from 2 to 5

# A tibble: 87 × 5
   USUBJID    ARM   DSTERM            DSDECOD DSCAT
   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt;
 1 ABC-01-049 ARM D SUBJECT COMPLETE… COMPLE… DISP…
 2 ABC-01-050 ARM B SUBJECT COMPLETE… COMPLE… DISP…
 3 ABC-01-051 ARM A SUBJECT COMPLETE… COMPLE… DISP…
 4 ABC-01-052 ARM C SUBJECT COMPLETE… COMPLE… DISP…
 5 ABC-01-053 ARM B NON-COMPLIANCE W… NON-CO… DISP…
 6 ABC-01-054 ARM D SUBJECT COMPLETE… COMPLE… DISP…
 7 ABC-01-055 ARM C SUBJECT COMPLETE… COMPLE… DISP…
 8 ABC-01-056 ARM A SUBJECT COMPLETE… COMPLE… DISP…
 9 ABC-01-113 ARM D SUBJECT COMPLETE… COMPLE… DISP…
10 ABC-01-114 ARM B SUBJECT COMPLETE… COMPLE… DISP…
# ℹ 77 more rows
# ℹ Use `print(n = ...)` to see more rows

Change ARM to factor to assist with sparse data

Get ARM population counts

proc_freq: input data set 85 rows and 2 columns
           tables: ARM
           output: long
           view: TRUE
           output: 1 datasets

# A tibble: 1 × 6
  VAR   STAT  `ARM A` `ARM B` `ARM C` `ARM D`
  &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 ARM   CNT        20      21      21      23

# A user-defined format: 2 conditions
  Name Type
1  obj    U
2  obj    U
                                                              Expression
1          x == "SUBJECT COMPLETED ALL VISITS AND PROTOCOL REQUIREMENTS"
2 x == "SUBJECT COMPLETED ALL VISITS BUT WITH MAJOR PROTOCOL VIOLATIONS"
                                                            Label
1          Subject Completed All Visits And Protocol Requirements
2 Subject Completed All Visits But With Major Protocol Violations
  Order
1    NA
2    NA

# A user-defined format: 1 conditions
  Name Type                            Expression
1  obj    U x == "NON-COMPLIANCE WITH STUDY DRUG"
                           Label Order
1 Non-Compliance With Study Drug    NA

# A user-defined format: 3 conditions
  Name Type              Expression
1  obj    U x == "LACK OF EFFICACY"
2  obj    U   str_detect(x, "LOST")
3  obj    U                    TRUE
              Label Order
1  Lack Of Efficacy    NA
2 Lost To Follow Up    NA
3  Lack Of Efficacy    NA

# A user-defined format: 3 conditions
  Name Type           Expression
1  obj    U     x == "COMPLETED"
2  obj    U x == "NONCOMPLIANCE"
3  obj    U         x == "OTHER"
                                      Label Order
1              Subjects who Completed Study    NA
2 Subjects terminated due to non-compliance    NA
3             Subjects who terminated early    NA

Create vector of final dataframe columns

group
cat
catseq
ARM A
ARM B
ARM C
ARM D

Get group counts

proc_freq: input data set 87 rows and 5 columns
           tables: DSDECOD
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 12 × 6
   BY    VAR     CAT                  N   CNT   PCT
   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 ARM A DSDECOD COMPLETED           20    19 95   
 2 ARM A DSDECOD NON-COMPLIANCE …    20     0  0   
 3 ARM A DSDECOD OTHER               20     1  5   
 4 ARM B DSDECOD COMPLETED           21    17 81.0 
 5 ARM B DSDECOD NON-COMPLIANCE …    21     1  4.76
 6 ARM B DSDECOD OTHER               21     3 14.3 
 7 ARM C DSDECOD COMPLETED           21    16 76.2 
 8 ARM C DSDECOD NON-COMPLIANCE …    21     0  0   
 9 ARM C DSDECOD OTHER               21     5 23.8 
10 ARM D DSDECOD COMPLETED           23    20 87.0 
11 ARM D DSDECOD NON-COMPLIANCE …    23     0  0   
12 ARM D DSDECOD OTHER               23     3 13.0 

datastep: columns decreased from 6 to 3

# A tibble: 12 × 3
   BY    CAT                            CNTPCT     
   &lt;chr&gt; &lt;chr&gt;                          &lt;chr&gt;      
 1 ARM A COMPLETED                      19 ( 95.0%)
 2 ARM A NON-COMPLIANCE WITH STUDY DRUG 0 (  0.0%) 
 3 ARM A OTHER                          1 (  5.0%) 
 4 ARM B COMPLETED                      17 ( 81.0%)
 5 ARM B NON-COMPLIANCE WITH STUDY DRUG 1 (  4.8%) 
 6 ARM B OTHER                          3 ( 14.3%) 
 7 ARM C COMPLETED                      16 ( 76.2%)
 8 ARM C NON-COMPLIANCE WITH STUDY DRUG 0 (  0.0%) 
 9 ARM C OTHER                          5 ( 23.8%) 
10 ARM D COMPLETED                      20 ( 87.0%)
11 ARM D NON-COMPLIANCE WITH STUDY DRUG 0 (  0.0%) 
12 ARM D OTHER                          3 ( 13.0%) 

proc_transpose: input data set 12 rows and 3 columns
                by: CAT
                var: CNTPCT
                id: BY
                name: NAME
                output dataset 3 rows and 6 columns

# A tibble: 3 × 6
  CAT         NAME  `ARM A` `ARM B` `ARM C` `ARM D`
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 COMPLETED   CNTP… 19 ( 9… 17 ( 8… 16 ( 7… 20 ( 8…
2 NON-COMPLI… CNTP… 0 (  0… 1 (  4… 0 (  0… 0 (  0…
3 OTHER       CNTP… 1 (  5… 3 ( 14… 5 ( 23… 3 ( 13…

datastep: columns increased from 6 to 7

# A tibble: 3 × 7
  group        cat   catseq `ARM A` `ARM B` `ARM C`
  &lt;chr&gt;        &lt;lgl&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 COMPLETED    NA         1 19 ( 9… 17 ( 8… 16 ( 7…
2 NONCOMPLIAN… NA         1 0 (  0… 1 (  4… 0 (  0…
3 OTHER        NA         1 1 (  5… 3 ( 14… 5 ( 23…
# ℹ 1 more variable: `ARM D` &lt;chr&gt;

Pull out subjects who completed study.

datastep: columns increased from 5 to 6

# A tibble: 74 × 6
   USUBJID    ARM   DSTERM  DSDECOD DSCAT TERMDECOD
   &lt;chr&gt;      &lt;fct&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    
 1 ABC-01-049 ARM D SUBJEC… COMPLE… DISP… Subject …
 2 ABC-01-050 ARM B SUBJEC… COMPLE… DISP… Subject …
 3 ABC-01-051 ARM A SUBJEC… COMPLE… DISP… Subject …
 4 ABC-01-052 ARM C SUBJEC… COMPLE… DISP… Subject …
 5 ABC-01-054 ARM D SUBJEC… COMPLE… DISP… Subject …
 6 ABC-01-055 ARM C SUBJEC… COMPLE… DISP… Subject …
 7 ABC-01-056 ARM A SUBJEC… COMPLE… DISP… Subject …
 8 ABC-01-113 ARM D SUBJEC… COMPLE… DISP… Subject …
 9 ABC-01-114 ARM B SUBJEC… COMPLE… DISP… Subject …
10 ABC-02-033 ARM C SUBJEC… COMPLE… DISP… Subject …
# ℹ 64 more rows
# ℹ Use `print(n = ...)` to see more rows

proc_freq: input data set 74 rows and 6 columns
           tables: DSDECOD * TERMDECOD
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 8 × 8
  BY    VAR1   VAR2  CAT1  CAT2      N   CNT    PCT
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 ARM A DSDEC… TERM… COMP… Subj…    19    19 100   
2 ARM A DSDEC… TERM… COMP… Subj…    19     0   0   
3 ARM B DSDEC… TERM… COMP… Subj…    17    16  94.1 
4 ARM B DSDEC… TERM… COMP… Subj…    17     1   5.88
5 ARM C DSDEC… TERM… COMP… Subj…    16    16 100   
6 ARM C DSDEC… TERM… COMP… Subj…    16     0   0   
7 ARM D DSDEC… TERM… COMP… Subj…    20    20 100   
8 ARM D DSDEC… TERM… COMP… Subj…    20     0   0   

datastep: columns decreased from 8 to 4

# A tibble: 8 × 4
  BY    CAT1      CAT2                       CNTPCT
  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                      &lt;chr&gt; 
1 ARM A COMPLETED Subject Completed All Vis… 19 ( …
2 ARM A COMPLETED Subject Completed All Vis… 0 (  …
3 ARM B COMPLETED Subject Completed All Vis… 16 ( …
4 ARM B COMPLETED Subject Completed All Vis… 1 (  …
5 ARM C COMPLETED Subject Completed All Vis… 16 ( …
6 ARM C COMPLETED Subject Completed All Vis… 0 (  …
7 ARM D COMPLETED Subject Completed All Vis… 20 ( …
8 ARM D COMPLETED Subject Completed All Vis… 0 (  …

proc_transpose: input data set 8 rows and 4 columns
                by: CAT1 CAT2
                var: CNTPCT
                id: BY
                name: NAME
                output dataset 2 rows and 7 columns

# A tibble: 2 × 7
  CAT1  CAT2  NAME  `ARM A` `ARM B` `ARM C` `ARM D`
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 COMP… Subj… CNTP… 19 ( 9… 16 ( 7… 16 ( 7… 20 ( 8…
2 COMP… Subj… CNTP… 0 (  0… 1 (  4… 0 (  0… 0 (  0…

datastep: columns started with 7 and ended with 7

# A tibble: 2 × 7
  group     cat      catseq `ARM A` `ARM B` `ARM C`
  &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 COMPLETED Subject…      2 19 ( 9… 16 ( 7… 16 ( 7…
2 COMPLETED Subject…      2 0 (  0… 1 (  4… 0 (  0…
# ℹ 1 more variable: `ARM D` &lt;chr&gt;

Pull out subjects who were non-compliant

datastep: columns increased from 5 to 6

# A tibble: 1 × 6
  USUBJID    ARM   DSTERM   DSDECOD DSCAT TERMDECOD
  &lt;chr&gt;      &lt;fct&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    
1 ABC-01-053 ARM B NON-COM… NON-CO… DISP… Non-Comp…

proc_freq: input data set 1 rows and 6 columns
           tables: DSDECOD * TERMDECOD
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 4 × 8
  BY    VAR1    VAR2  CAT1  CAT2      N   CNT   PCT
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 ARM A DSDECOD TERM… NON-… Non-…     0     0   NaN
2 ARM B DSDECOD TERM… NON-… Non-…     1     1   100
3 ARM C DSDECOD TERM… NON-… Non-…     0     0   NaN
4 ARM D DSDECOD TERM… NON-… Non-…     0     0   NaN

datastep: columns decreased from 8 to 4

# A tibble: 4 × 4
  BY    CAT1                           CAT2  CNTPCT
  &lt;chr&gt; &lt;chr&gt;                          &lt;chr&gt; &lt;chr&gt; 
1 ARM A NON-COMPLIANCE WITH STUDY DRUG Non-… 0 (  …
2 ARM B NON-COMPLIANCE WITH STUDY DRUG Non-… 1 (  …
3 ARM C NON-COMPLIANCE WITH STUDY DRUG Non-… 0 (  …
4 ARM D NON-COMPLIANCE WITH STUDY DRUG Non-… 0 (  …

proc_transpose: input data set 4 rows and 4 columns
                by: CAT1 CAT2
                var: CNTPCT
                id: BY
                name: NAME
                output dataset 1 rows and 7 columns

# A tibble: 1 × 7
  CAT1  CAT2  NAME  `ARM A` `ARM B` `ARM C` `ARM D`
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 NON-… Non-… CNTP… 0 (  0… 1 (  4… 0 (  0… 0 (  0…

datastep: columns started with 7 and ended with 7

# A tibble: 1 × 7
  group        cat   catseq `ARM A` `ARM B` `ARM C`
  &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 NONCOMPLIAN… Non-…      2 0 (  0… 1 (  4… 0 (  0…
# ℹ 1 more variable: `ARM D` &lt;chr&gt;

Pull out subjects who terminated early

datastep: columns increased from 5 to 6

# A tibble: 12 × 6
   USUBJID    ARM   DSTERM  DSDECOD DSCAT TERMDECOD
   &lt;chr&gt;      &lt;fct&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    
 1 ABC-03-005 ARM C LOST O… OTHER   DISP… Lost To …
 2 ABC-03-008 ARM D WORSEN… OTHER   DISP… Lack Of …
 3 ABC-04-074 ARM C LACK O… OTHER   DISP… Lack Of …
 4 ABC-04-128 ARM C LOST T… OTHER   DISP… Lost To …
 5 ABC-06-069 ARM A PSORIA… OTHER   DISP… Lack Of …
 6 ABC-06-161 ARM C NON  R… OTHER   DISP… Lack Of …
 7 ABC-08-103 ARM B LOST T… OTHER   DISP… Lost To …
 8 ABC-08-105 ARM C MOTHER… OTHER   DISP… Lack Of …
 9 ABC-08-107 ARM D PATIEN… OTHER   DISP… Lack Of …
10 ABC-08-108 ARM B LOST T… OTHER   DISP… Lost To …
11 ABC-09-021 ARM B LOST T… OTHER   DISP… Lost To …
12 ABC-09-022 ARM D LOST T… OTHER   DISP… Lost To …

proc_freq: input data set 12 rows and 6 columns
           tables: DSDECOD * TERMDECOD
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 8 × 8
  BY    VAR1    VAR2  CAT1  CAT2      N   CNT   PCT
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 ARM A DSDECOD TERM… OTHER Lack…     1     1 100  
2 ARM A DSDECOD TERM… OTHER Lost…     1     0   0  
3 ARM B DSDECOD TERM… OTHER Lack…     3     0   0  
4 ARM B DSDECOD TERM… OTHER Lost…     3     3 100  
5 ARM C DSDECOD TERM… OTHER Lack…     5     3  60  
6 ARM C DSDECOD TERM… OTHER Lost…     5     2  40  
7 ARM D DSDECOD TERM… OTHER Lack…     3     2  66.7
8 ARM D DSDECOD TERM… OTHER Lost…     3     1  33.3

datastep: columns decreased from 8 to 4

# A tibble: 8 × 4
  BY    CAT1  CAT2              CNTPCT    
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;     
1 ARM A OTHER Lack Of Efficacy  1 (  5.0%)
2 ARM A OTHER Lost To Follow Up 0 (  0.0%)
3 ARM B OTHER Lack Of Efficacy  0 (  0.0%)
4 ARM B OTHER Lost To Follow Up 3 ( 14.3%)
5 ARM C OTHER Lack Of Efficacy  3 ( 14.3%)
6 ARM C OTHER Lost To Follow Up 2 (  9.5%)
7 ARM D OTHER Lack Of Efficacy  2 (  8.7%)
8 ARM D OTHER Lost To Follow Up 1 (  4.3%)

proc_transpose: input data set 8 rows and 4 columns
                by: CAT1 CAT2
                var: CNTPCT
                id: BY
                name: NAME
                output dataset 2 rows and 7 columns

# A tibble: 2 × 7
  CAT1  CAT2  NAME  `ARM A` `ARM B` `ARM C` `ARM D`
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 OTHER Lack… CNTP… 1 (  5… 0 (  0… 3 ( 14… 2 (  8…
2 OTHER Lost… CNTP… 0 (  0… 3 ( 14… 2 (  9… 1 (  4…

datastep: columns started with 7 and ended with 7

# A tibble: 2 × 7
  group cat          catseq `ARM A` `ARM B` `ARM C`
  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 OTHER Lack Of Eff…      2 1 (  5… 0 (  0… 3 ( 14…
2 OTHER Lost To Fol…      2 0 (  0… 3 ( 14… 2 (  9…
# ℹ 1 more variable: `ARM D` &lt;chr&gt;

Combine blocks into final data frame

datastep: columns increased from 7 to 8

# A tibble: 8 × 8
  group        cat   catseq `ARM A` `ARM B` `ARM C`
  &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 COMPLETED    &lt;NA&gt;       1 19 ( 9… 17 ( 8… 16 ( 7…
2 NONCOMPLIAN… &lt;NA&gt;       1 0 (  0… 1 (  4… 0 (  0…
3 OTHER        &lt;NA&gt;       1 1 (  5… 3 ( 14… 5 ( 23…
4 COMPLETED    Subj…      2 19 ( 9… 16 ( 7… 16 ( 7…
5 COMPLETED    Subj…      2 0 (  0… 1 (  4… 0 (  0…
6 NONCOMPLIAN… Non-…      2 0 (  0… 1 (  4… 0 (  0…
7 OTHER        Lack…      2 1 (  5… 0 (  0… 3 ( 14…
8 OTHER        Lost…      2 0 (  0… 3 ( 14… 2 (  9…
# ℹ 2 more variables: `ARM D` &lt;chr&gt;, lblind &lt;lgl&gt;

proc_sort: input data set 8 rows and 8 columns
           by: group catseq cat
           keep: group cat catseq ARM A ARM B ARM C ARM D lblind
           order: a a a
           output data set 8 rows and 8 columns

# A tibble: 8 × 8
  group        cat   catseq `ARM A` `ARM B` `ARM C`
  &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 COMPLETED    &lt;NA&gt;       1 19 ( 9… 17 ( 8… 16 ( 7…
2 COMPLETED    Subj…      2 19 ( 9… 16 ( 7… 16 ( 7…
3 COMPLETED    Subj…      2 0 (  0… 1 (  4… 0 (  0…
4 NONCOMPLIAN… &lt;NA&gt;       1 0 (  0… 1 (  4… 0 (  0…
5 NONCOMPLIAN… Non-…      2 0 (  0… 1 (  4… 0 (  0…
6 OTHER        &lt;NA&gt;       1 1 (  5… 3 ( 14… 5 ( 23…
7 OTHER        Lack…      2 1 (  5… 0 (  0… 3 ( 14…
8 OTHER        Lost…      2 0 (  0… 3 ( 14… 2 (  9…
# ℹ 2 more variables: `ARM D` &lt;chr&gt;, lblind &lt;lgl&gt;

=========================================================================
Create and print report
=========================================================================

# A report specification: 1 pages
- file_path: 'C:\Users\dbosa\AppData\Local\Temp\RtmpEBPgPu/example10.pdf'
- output_type: PDF
- units: inches
- orientation: landscape
- margins: top 1 bottom 1 left 1 right 1
- line size/count: 9/41
- content: 
# A table specification:
- data: tibble 'final' 8 rows 8 cols
- show_cols: all
- use_attributes: all
- width: 8.5
- title 1: 'Table 5.2.3'
- title 2: 'Subject Disposition by Category and Treatment Group'
- title 3: 'Safety Population'
- footnote 1: 'Program: DS_Table.R'
- footnote 2: 'NOTE: Denominator based on number of non-missing responses.'
- stub: group cat 'Completion Status' align='left' 
- define: group dedupe='TRUE' 
- define: cat 
- define: catseq visible='FALSE' 
- define: ARM A 'Placebo' 
- define: ARM B 'Drug 50mg' 
- define: ARM C 'Drug 100mg' 
- define: ARM D 'Competitor' 
- define: lblind visible='FALSE' 

lib_sync: synchronized data in library 'sdtm'

=========================================================================
Log End Time: 2023-09-05 22:06:09.329367
Log Elapsed Time: 0 00:00:04
=========================================================================

</code></pre>
<p>Next: <a href="sassy-plisting.html">Example 11: Subject
Listing</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
