<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example 9: Forest Plot â€¢ sassy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example 9: Forest Plot">
<meta property="og:description" content="sassy">
<meta property="og:image" content="https://sassy.r-sassy.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sassy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sassy.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sassy-listing.html">Example 1: Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-dm.html">Example 2: Demographics Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figure.html">Example 3: Figures</a>
    </li>
    <li>
      <a href="../articles/sassy-ae.html">Example 4: Adverse Events Table</a>
    </li>
    <li>
      <a href="../articles/sassy-vs.html">Example 5: Vital Signs Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figureby.html">Example 6: Figure with By Group</a>
    </li>
    <li>
      <a href="../articles/sassy-survival.html">Example 7: Survival Analysis</a>
    </li>
    <li>
      <a href="../articles/sassy-profile.html">Example 8: Patient Profile</a>
    </li>
    <li>
      <a href="../articles/sassy-forest.html">Example 9: Forest Plot</a>
    </li>
    <li>
      <a href="../articles/sassy-ds.html">Example 10: Disposition Table</a>
    </li>
    <li>
      <a href="../articles/sassy-plisting.html">Example 11: Subject Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-pfigure.html">Example 12: Combined Figure</a>
    </li>
    <li>
      <a href="../articles/sassy-disclaimers.html">Disclaimers</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href=".././articles/sassy-faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/dbosak01/sassy/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sassy-forest_files/header-attrs-2.14/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example 9: Forest Plot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/sassy/blob/master/vignettes/sassy-forest.Rmd"><code>vignettes/sassy-forest.Rmd</code></a></small>
      <div class="hidden name"><code>sassy-forest.Rmd</code></div>

    </div>

    
    
<p>The <strong>reporter</strong> package is able to embed JPEG images
into a report. Here is an example using an image saved from the
<strong>forestploter</strong> package. This package creates customizable
forest plots. The technique shown here can be used to embed images from
any package.</p>
<div id="program" class="section level2">
<h2 class="hasAnchor">
<a href="#program" class="anchor"></a>Program</h2>
<p>Note the following about this example:</p>
<ul>
<li>The <strong><a href="https://CRAN.R-project.org/package=forestploter">forestploter</a></strong>
package creates customizable forest plots.<br>
</li>
<li>The <strong><a href="https://reporter.r-sassy.org">reporter</a></strong> package can
embed JPEG images into any output type that accepts images.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adayim/forestploter">forestploter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-sassy.org">sassy</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"logr.notes"</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        <span class="st">"logr.autolog"</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Get temp directory</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Open log</span></span>
<span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="fu">log_open</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example9.log"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Prepare Data ------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Prepare Data"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Read example data from forestploter package"</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_data.csv"</span>, package <span class="op">=</span> <span class="st">"forestploter"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Keep needed columns"</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Indent the subgroup if there is a number in the placebo column"</span><span class="op">)</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">Subgroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">Placebo</span><span class="op">)</span>, </span>
<span>                      <span class="va">dt</span><span class="op">$</span><span class="va">Subgroup</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"   "</span>, <span class="va">dt</span><span class="op">$</span><span class="va">Subgroup</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"NA to blank or NA will be transformed to character."</span><span class="op">)</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">Treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">Treatment</span><span class="op">)</span>, <span class="st">""</span>, <span class="va">dt</span><span class="op">$</span><span class="va">Treatment</span><span class="op">)</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">Placebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">Placebo</span><span class="op">)</span>, <span class="st">""</span>, <span class="va">dt</span><span class="op">$</span><span class="va">Placebo</span><span class="op">)</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">se</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">hi</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">est</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Add blank column for the forest plot to display CI."</span><span class="op">)</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">` `</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">" "</span>, <span class="fl">20</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create confidence interval column to display"</span><span class="op">)</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">`HR (95% CI)`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">se</span><span class="op">)</span>, <span class="st">""</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f (%.2f to %.2f)"</span>,</span>
<span>                                   <span class="va">dt</span><span class="op">$</span><span class="va">est</span>, <span class="va">dt</span><span class="op">$</span><span class="va">low</span>, <span class="va">dt</span><span class="op">$</span><span class="va">hi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Final data frame"</span><span class="op">)</span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create Plot -------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create Plot"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Assign Forest Properties"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/forestploter/man/forest.html">forest</a></span><span class="op">(</span><span class="va">dt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  est <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">est</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">low</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">hi</span>,</span>
<span>  sizes <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">se</span>,</span>
<span>  ci_column <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  ref_line <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow_lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Placebo Better"</span>, <span class="st">"Treatment Better"</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  ticks_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create temp file name"</span><span class="op">)</span></span>
<span><span class="va">tmppth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".jpg"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">put</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Turn on jpeg device context"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">jpeg</a></span><span class="op">(</span><span class="va">tmppth</span>, width <span class="op">=</span> <span class="fl">600</span>, height <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Print plot"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Turn off device context"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create Report -----------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create Report"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create plot object from jpeg file"</span><span class="op">)</span></span>
<span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu">create_plot</span><span class="op">(</span><span class="va">tmppth</span>, <span class="fl">5.5</span>, <span class="fl">7.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Construct report file path"</span><span class="op">)</span></span>
<span><span class="va">pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example9.rtf"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Create report"</span><span class="op">)</span></span>
<span><span class="va">rpt</span> <span class="op">&lt;-</span> <span class="fu">create_report</span><span class="op">(</span><span class="va">pth</span>, output_type <span class="op">=</span> <span class="st">"RTF"</span>, font <span class="op">=</span> <span class="st">"Arial"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">titles</span><span class="op">(</span><span class="st">"Figure 3.1.4"</span>, <span class="st">"Forest Plot Comparison of Treated vs. Placebo"</span>,</span>
<span>         <span class="st">"Safety Population"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, blank_row <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">add_content</span><span class="op">(</span><span class="va">plt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">footnotes</span><span class="op">(</span><span class="st">"Program: {Sys.path()}"</span>, </span>
<span>           <span class="st">"Output: {basename(pth)}"</span>, blank_row <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">page_header</span><span class="op">(</span><span class="st">"Sponsor: Sassy"</span>, <span class="st">"Study: ABC"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">page_footer</span><span class="op">(</span><span class="st">"Date: {Sys.time()}"</span>, right <span class="op">=</span> <span class="st">"Page [pg] of [tpg]"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Write report"</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">write_report</span><span class="op">(</span><span class="va">rpt</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Uncomment to Show report</span></span>
<span><span class="co"># file.show(res$modified_path)</span></span>
<span></span>
<span><span class="co"># Uncomment to View Log</span></span>
<span><span class="co"># file.show(lf)</span></span>
<span></span>
<span></span>
<span><span class="co"># Clean Up ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Kill image file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span><span class="op">(</span><span class="va">tmppth</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">log_close</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="output" class="section level2">
<h2 class="hasAnchor">
<a href="#output" class="anchor"></a>Output</h2>
<p>Here is an image of the RTF report produced by the above example:</p>
<p><img src="../man/images/forest.png" align="center"></p>
</div>
<div id="log" class="section level2">
<h2 class="hasAnchor">
<a href="#log" class="anchor"></a>Log</h2>
<p>Here is the log produced by the above forest plot example:</p>
<pre><code>=========================================================================
Log Path: C:/Users/dbosa/AppData/Local/Temp/Rtmpc54HUz/log/example9.log
Program Path: C:/packages/sassy/vignettes/sassy-forest.Rmd
Working Directory: C:/packages/sassy/
User Name: dbosa
R Version: 4.2.1 (2022-06-23 ucrt)
Machine: SOCRATES x86-64
Operating System: Windows 10 x64 build 19044
Base Packages: grid stats graphics grDevices utils datasets methods base Other
Packages: tidylog_1.0.2 reporter_1.3.8 libr_1.2.6 fmtr_1.5.9 logr_1.3.3
common_1.0.4 sassy_1.0.8 magrittr_2.0.3 forestploter_0.2.1
Log Start Time: 2022-10-08 22:38:59
=========================================================================

=========================================================================
Prepare Data
=========================================================================

Read example data from forestploter package

Keep needed columns

                        Subgroup Treatment Placebo      est
1                   All Patients       781     780 1.869694
2                            Sex        NA      NA       NA
3                           Male       535     548 1.449472
4                         Female       246     232 2.275120
5                            Age        NA      NA       NA
6                         &lt;65 yr       297     333 1.509242
7                         &gt;65 yr       484     447 1.468828
8                         &lt;75 yr       638     649 1.477608
9                         &gt;75 yr       143     131 1.012617
10               Body-mass index        NA      NA       NA
11                       &lt;Median       394     385 1.185109
12                       &gt;Median       387     394 1.632055
13                          Race        NA      NA       NA
14                         White       653     685 1.168173
15                         Black       110      87 2.022034
16                         Other        18       8 2.622501
17     Baseline Statin Treatment        NA      NA       NA
18                           Yes       701     692 2.707430
19                            No        80      88 1.655263
20 Intensity of statin treatment        NA      NA       NA
21                          High       538     546 2.544263
22                      Not High       243     234 1.113885
          low       hi
1  0.13245636 3.606932
2          NA       NA
3  0.06834426 2.830600
4  0.50768005 4.042560
5          NA       NA
6  0.67029394 2.348190
7  0.45499227 2.482663
8  0.55014273 2.405073
9  0.34370612 1.681528
10         NA       NA
11 0.49170973 1.878509
12 0.01765042 3.246461
13         NA       NA
14 0.63731627 1.699029
15 0.82239156 3.221677
16 1.18092223 4.064081
17         NA       NA
18 1.17973879 4.235121
19 0.29133093 3.019195
20         NA       NA
21 0.88528342 4.203243
22 0.03848006 2.189290

Indent the subgroup if there is a number in the placebo column

   All Patients
Sex
     Male
     Female
Age
     &lt;65 yr
     &gt;65 yr
     &lt;75 yr
     &gt;75 yr
Body-mass index
     &lt;Median
     &gt;Median
Race
     White
     Black
     Other
Baseline Statin Treatment
     Yes
     No
Intensity of statin treatment
     High
     Not High

NA to blank or NA will be transformed to character.

Add blank column for the forest plot to display CI.

Create confidence interval column to display

Final data frame

                        Subgroup Treatment Placebo      est
1                   All Patients       781     780 1.869694
2                            Sex                         NA
3                           Male       535     548 1.449472
4                         Female       246     232 2.275120
5                            Age                         NA
6                         &lt;65 yr       297     333 1.509242
7                         &gt;65 yr       484     447 1.468828
8                         &lt;75 yr       638     649 1.477608
9                         &gt;75 yr       143     131 1.012617
10               Body-mass index                         NA
11                       &lt;Median       394     385 1.185109
12                       &gt;Median       387     394 1.632055
13                          Race                         NA
14                         White       653     685 1.168173
15                         Black       110      87 2.022034
16                         Other        18       8 2.622501
17     Baseline Statin Treatment                         NA
18                           Yes       701     692 2.707430
19                            No        80      88 1.655263
20 Intensity of statin treatment                         NA
21                          High       538     546 2.544263
22                      Not High       243     234 1.113885
          low       hi        se
1  0.13245636 3.606932 0.3352463
2          NA       NA        NA
3  0.06834426 2.830600 0.3414741
4  0.50768005 4.042560 0.2932884
5          NA       NA        NA
6  0.67029394 2.348190 0.2255292
7  0.45499227 2.482663 0.2677894
8  0.55014273 2.405073 0.2485489
9  0.34370612 1.681528 0.2587575
10         NA       NA        NA
11 0.49170973 1.878509 0.2350221
12 0.01765042 3.246461 0.3508801
13         NA       NA        NA
14 0.63731627 1.699029 0.1911307
15 0.82239156 3.221677 0.2376520
16 1.18092223 4.064081 0.2234995
17         NA       NA        NA
18 1.17973879 4.235121 0.2282715
19 0.29133093 3.019195 0.3066481
20         NA       NA        NA
21 0.88528342 4.203243 0.2561302
22 0.03848006 2.189290 0.3447568
                                                   HR (95% CI)
1                                          1.87 (0.13 to 3.61)
2                                                             
3                                          1.45 (0.07 to 2.83)
4                                          2.28 (0.51 to 4.04)
5                                                             
6                                          1.51 (0.67 to 2.35)
7                                          1.47 (0.45 to 2.48)
8                                          1.48 (0.55 to 2.41)
9                                          1.01 (0.34 to 1.68)
10                                                            
11                                         1.19 (0.49 to 1.88)
12                                         1.63 (0.02 to 3.25)
13                                                            
14                                         1.17 (0.64 to 1.70)
15                                         2.02 (0.82 to 3.22)
16                                         2.62 (1.18 to 4.06)
17                                                            
18                                         2.71 (1.18 to 4.24)
19                                         1.66 (0.29 to 3.02)
20                                                            
21                                         2.54 (0.89 to 4.20)
22                                         1.11 (0.04 to 2.19)

=========================================================================
Create Plot
=========================================================================

Assign Forest Properties

Create temp file name

C:\Users\dbosa\AppData\Local\Temp\Rtmpc54HUz\file4ce84b293714.jpg

Turn on jpeg device context

Print plot

Turn off device context

=========================================================================
Create Report
=========================================================================

Create plot object from jpeg file

Construct report file path

Create report

Write report

# A report specification: 1 pages
- file_path: 'C:\Users\dbosa\AppData\Local\Temp\Rtmpc54HUz/example9.rtf'
- output_type: RTF
- units: inches
- orientation: landscape
- margins: top 0.5 bottom 0.5 left 1 right 1
- line size/count: 9/42
- page_header: left=Sponsor: Sassy right=Study: ABC
- title 1: 'Figure 3.1.4'
- title 2: 'Forest Plot Comparison of Treated vs. Placebo'
- title 3: 'Safety Population'
- footnote 1: 'Program: C:/packages/sassy/vignettes/sassy-forest.Rmd'
- footnote 2: 'Output: example9.rtf'
- page_footer: left=Date: 2022-10-08 22:38:59 center= right=Page [pg] of [tpg]
- content: 
# A plot specification: 
- path: 'C:\Users\dbosa\AppData\Local\Temp\Rtmpc54HUz\file4ce84b293714.jpg'
- height: 5.5
- width: 7.5

=========================================================================
Log End Time: 2022-10-08 22:38:59
Log Elapsed Time: 0 00:00:00
=========================================================================

</code></pre>
<p>Next: <a href="sassy-ds.html">Example 10: Disposition Table</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
