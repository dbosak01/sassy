<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example 15: Intext Table • sassy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example 15: Intext Table">
<meta property="og:description" content="sassy">
<meta property="og:image" content="https://sassy.r-sassy.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sassy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/sassy.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sassy-listing.html">Example 1: Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-dm.html">Example 2: Demographics Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figure.html">Example 3: Figures</a>
    </li>
    <li>
      <a href="../articles/sassy-ae.html">Example 4: Adverse Events Table</a>
    </li>
    <li>
      <a href="../articles/sassy-vs.html">Example 5: Vital Signs Table</a>
    </li>
    <li>
      <a href="../articles/sassy-figureby.html">Example 6: Figure with By Group</a>
    </li>
    <li>
      <a href="../articles/sassy-survival.html">Example 7: Survival Analysis</a>
    </li>
    <li>
      <a href="../articles/sassy-profile.html">Example 8: Patient Profile</a>
    </li>
    <li>
      <a href="../articles/sassy-forest.html">Example 9: Forest Plot</a>
    </li>
    <li>
      <a href="../articles/sassy-ds.html">Example 10: Disposition Table</a>
    </li>
    <li>
      <a href="../articles/sassy-plisting.html">Example 11: Subject Listing</a>
    </li>
    <li>
      <a href="../articles/sassy-pfigure.html">Example 12: Combined Figure</a>
    </li>
    <li>
      <a href="../articles/sassy-chgbase.html">Example 13: Mean Change From Baseline</a>
    </li>
    <li>
      <a href="../articles/sassy-ae2.html">Example 14: AE Severity in Rows</a>
    </li>
    <li>
      <a href="../articles/sassy-intext.html">Example 15: Intext Table</a>
    </li>
    <li>
      <a href="../articles/sassy-shift.html">Example 16: Shift Table</a>
    </li>
    <li>
      <a href="../articles/sassy-disclaimers.html">Disclaimers</a>
    </li>
    <li>
      <a href="../articles/sassy-faq.html">Frequently Asked Questions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href=".././articles/sassy-faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/dbosak01/sassy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example 15: Intext Table</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/sassy/blob/HEAD/vignettes/sassy-intext.Rmd" class="external-link"><code>vignettes/sassy-intext.Rmd</code></a></small>
      <div class="hidden name"><code>sassy-intext.Rmd</code></div>

    </div>

    
    
<p>This example produces both stand-alone and “intext” versions of a
simple demographics summary table. The stand-alone version is created in
PDF and contains page header and footer information. Also, the titles
are in the body of the table. The “intext” version is created in RTF and
the page headers and footers have been removed. Additionally, the titles
have been moved to the page header. The purpose of this arrangement is
so that the table can be easily copied to another document for medical
writing.</p>
<div class="section level2">
<h2 id="program">Program<a class="anchor" aria-label="anchor" href="#program"></a>
</h2>
<p>Note the following about this example:</p>
<ul>
<li>Formats are created with the <code>as.factor = TRUE</code> parameter
to allow non-alphabetic sorting and to show all frequency
categories.</li>
<li>The analysis is the same for both stand-alone and “intext”
reports.</li>
<li>Separate reporting calls are performed for each version of the
report to comply with the different layout requirements.</li>
<li>The <code>continuous = TRUE</code> parameter has been set on the
“intext” table to create one continuous table instead of separate tables
for each page.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-sassy.org" class="external-link">sassy</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare Log -------------------------------------------------------------</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"logr.autolog"</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        <span class="st">"logr.on"</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        <span class="st">"logr.notes"</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        <span class="st">"procs.print"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get temp directory</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Open log</span></span>
<span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="fu">log_open</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example15.log"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Prepare formats ---------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Prepare formats"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Age categories"</span><span class="op">)</span></span>
<span><span class="va">agecat</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"Missing"</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">29</span>, <span class="st">"18 to 29"</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span><span class="fl">30</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">39</span>, <span class="st">"30 to 39"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span><span class="fl">40</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span><span class="fl">49</span>, <span class="st">"40 to 49"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">50</span>, <span class="st">"&gt;= 50"</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                as.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Sex decodes"</span><span class="op">)</span></span>
<span><span class="va">fmt_sex</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"Missing"</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                 <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"M"</span>, <span class="st">"Male"</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                 <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"F"</span>, <span class="st">"Female"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 <span class="fu">condition</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="st">"Other"</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                 as.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Race decodes"</span><span class="op">)</span></span>
<span><span class="va">fmt_race</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"Missing"</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                  <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"WHITE"</span>, <span class="st">"White"</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"BLACK OR AFRICAN AMERICAN"</span>, <span class="st">"Black or African American"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                  <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ASIAN"</span>, <span class="st">"Asian or Pacific Islander"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                  <span class="fu">condition</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="st">"Unkown"</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>                  as.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Ethnic decodes"</span><span class="op">)</span></span>
<span><span class="va">fmt_ethnic</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"Missing"</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                    <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"HISPANIC OR LATINO"</span>, <span class="st">"Hispanic or Latino"</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                    <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"NOT HISPANIC OR LATINO"</span>, <span class="st">"Not Hispanic or Latino"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                    <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"UNKNOWN"</span>, <span class="st">"Unknown"</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                    as.factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"ARM decodes"</span><span class="op">)</span></span>
<span><span class="va">fmt_arm</span> <span class="op">&lt;-</span> <span class="fu">value</span><span class="op">(</span><span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM A"</span>, <span class="st">"Placebo"</span><span class="op">)</span>,</span>
<span>                 <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM B"</span>, <span class="st">"Drug 10mg"</span><span class="op">)</span>,</span>
<span>                 <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM C"</span>, <span class="st">"Drug 20mg"</span><span class="op">)</span>,</span>
<span>                 <span class="fu">condition</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"ARM D"</span>, <span class="st">"Competitor"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Compile format catalog"</span><span class="op">)</span></span>
<span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu">fcat</span><span class="op">(</span>MEAN <span class="op">=</span> <span class="st">"%.1f"</span>, STD <span class="op">=</span> <span class="st">"(%.2f)"</span>, </span>
<span>           Q1 <span class="op">=</span> <span class="st">"%.1f"</span>, Q3 <span class="op">=</span> <span class="st">"%.1f"</span>,</span>
<span>           MIN <span class="op">=</span> <span class="st">"%d"</span>, MAX <span class="op">=</span> <span class="st">"%d"</span>, </span>
<span>           CNT <span class="op">=</span> <span class="st">"%2d"</span>, PCT <span class="op">=</span> <span class="st">"(%5.1f%%)"</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co"># Load and Prepare Data ---------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Prepare Data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get sample data path</span></span>
<span><span class="va">pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"sassy"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Open data library"</span><span class="op">)</span></span>
<span><span class="fu">libname</span><span class="op">(</span><span class="va">sdtm</span>, <span class="va">pth</span>, <span class="st">"csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Extract DM dataset"</span><span class="op">)</span></span>
<span><span class="va">datdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sdtm</span><span class="op">$</span><span class="va">DM</span>, <span class="va">ARM</span> <span class="op">!=</span> <span class="st">'SCREEN FAILURE'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Apply formats"</span><span class="op">)</span></span>
<span><span class="va">datdm</span><span class="op">$</span><span class="va">AGECAT</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">datdm</span><span class="op">$</span><span class="va">AGE</span>, <span class="va">agecat</span><span class="op">)</span> </span>
<span><span class="va">datdm</span><span class="op">$</span><span class="va">SEXF</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">datdm</span><span class="op">$</span><span class="va">SEX</span>, <span class="va">fmt_sex</span><span class="op">)</span></span>
<span><span class="va">datdm</span><span class="op">$</span><span class="va">RACEF</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">datdm</span><span class="op">$</span><span class="va">RACE</span>, <span class="va">fmt_race</span><span class="op">)</span></span>
<span><span class="va">datdm</span><span class="op">$</span><span class="va">ARMF</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">datdm</span><span class="op">$</span><span class="va">ARM</span>, <span class="va">fmt_arm</span><span class="op">)</span></span>
<span><span class="va">datdm</span><span class="op">$</span><span class="va">ETHNICF</span> <span class="op">&lt;-</span> <span class="fu">fapply</span><span class="op">(</span><span class="va">datdm</span><span class="op">$</span><span class="va">ETHNIC</span>, <span class="va">fmt_ethnic</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get ARM population counts"</span><span class="op">)</span></span>
<span><span class="fu">proc_freq</span><span class="op">(</span><span class="va">datdm</span>, tables <span class="op">=</span> <span class="va">ARM</span>, </span>
<span>          output <span class="op">=</span> <span class="va">long</span>,</span>
<span>          options <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">nopercent</span>, <span class="va">nonobs</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">arm_pop</span></span>
<span></span>
<span><span class="co"># Age Summary Block -------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create summary statistics for age"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Call means procedure to get summary statistics for age"</span><span class="op">)</span></span>
<span><span class="fu">proc_means</span><span class="op">(</span><span class="va">datdm</span>, var <span class="op">=</span> <span class="va">AGE</span>,</span>
<span>           stats <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">std</span>, <span class="va">median</span>, <span class="va">q1</span>, <span class="va">q3</span>, <span class="va">min</span>, <span class="va">max</span><span class="op">)</span>,</span>
<span>           by <span class="op">=</span> <span class="va">ARM</span>, </span>
<span>           options <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">notype</span>, <span class="va">nofreq</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">age_stats</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Combine stats"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">age_stats</span>, </span>
<span>         format <span class="op">=</span> <span class="va">fc</span>,</span>
<span>         drop <span class="op">=</span> <span class="fu">find.names</span><span class="op">(</span><span class="va">age_stats</span>, start <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, </span>
<span>         <span class="op">{</span></span>
<span>           <span class="va">`Mean (SD)`</span> <span class="op">&lt;-</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">MEAN</span>, <span class="va">STD</span><span class="op">)</span></span>
<span>           <span class="va">Median</span> <span class="op">&lt;-</span> <span class="va">MEDIAN</span></span>
<span>           <span class="va">`Q1 - Q3`</span> <span class="op">&lt;-</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">Q1</span>, <span class="va">Q3</span>, sep <span class="op">=</span> <span class="st">" - "</span><span class="op">)</span></span>
<span>           <span class="va">`Min - Max`</span> <span class="op">&lt;-</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">MIN</span>, <span class="va">MAX</span>, sep <span class="op">=</span> <span class="st">" - "</span><span class="op">)</span></span>
<span>           </span>
<span>           </span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">age_comb</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Transpose ARMs into columns"</span><span class="op">)</span></span>
<span><span class="fu">proc_transpose</span><span class="op">(</span><span class="va">age_comb</span>, </span>
<span>               var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">age_comb</span><span class="op">)</span>,</span>
<span>               copy <span class="op">=</span> <span class="va">VAR</span>, id <span class="op">=</span> <span class="va">BY</span>, </span>
<span>               name <span class="op">=</span> <span class="va">LABEL</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">age_block</span></span>
<span></span>
<span></span>
<span><span class="co"># Age Group Block ----------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create frequency counts for Age Group"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get age group frequency counts"</span><span class="op">)</span></span>
<span><span class="fu">proc_freq</span><span class="op">(</span><span class="va">datdm</span>,</span>
<span>          table <span class="op">=</span> <span class="va">AGECAT</span>,</span>
<span>          by <span class="op">=</span> <span class="va">ARM</span>,</span>
<span>          options <span class="op">=</span> <span class="va">nonobs</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ageg_freq</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Combine counts and percents and assign age group factor for sorting"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">ageg_freq</span>,</span>
<span>         format <span class="op">=</span> <span class="va">fc</span>,</span>
<span>         keep <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">VAR</span>, <span class="va">LABEL</span>, <span class="va">BY</span>, <span class="va">CNTPCT</span><span class="op">)</span>,</span>
<span>         <span class="op">{</span></span>
<span>           <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">PCT</span><span class="op">)</span></span>
<span>           <span class="va">LABEL</span> <span class="op">&lt;-</span> <span class="va">CAT</span></span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ageg_comb</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Tranpose age group block"</span><span class="op">)</span></span>
<span><span class="fu">proc_transpose</span><span class="op">(</span><span class="va">ageg_comb</span>,</span>
<span>               var <span class="op">=</span> <span class="va">CNTPCT</span>,</span>
<span>               copy <span class="op">=</span> <span class="va">VAR</span>,</span>
<span>               id <span class="op">=</span> <span class="va">BY</span>,</span>
<span>               by <span class="op">=</span> <span class="va">LABEL</span>, </span>
<span>               options <span class="op">=</span> <span class="va">noname</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ageg_block</span></span>
<span></span>
<span><span class="co"># Sex Block ---------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create frequency counts for SEX"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get sex frequency counts"</span><span class="op">)</span></span>
<span><span class="fu">proc_freq</span><span class="op">(</span><span class="va">datdm</span>, tables <span class="op">=</span> <span class="va">SEXF</span>,</span>
<span>          by <span class="op">=</span> <span class="va">ARM</span>,</span>
<span>          options <span class="op">=</span> <span class="va">nonobs</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">sex_freq</span> </span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Combine counts and percents."</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">sex_freq</span>, </span>
<span>         format <span class="op">=</span> <span class="va">fc</span>, </span>
<span>         rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>CAT <span class="op">=</span> <span class="st">"LABEL"</span><span class="op">)</span>,</span>
<span>         drop <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">PCT</span><span class="op">)</span>, </span>
<span>         <span class="op">{</span></span>
<span>           </span>
<span>           <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">PCT</span><span class="op">)</span></span>
<span>           </span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">sex_comb</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Transpose ARMs into columns"</span><span class="op">)</span></span>
<span><span class="fu">proc_transpose</span><span class="op">(</span><span class="va">sex_comb</span>, id <span class="op">=</span> <span class="va">BY</span>, </span>
<span>               var <span class="op">=</span> <span class="va">CNTPCT</span>,</span>
<span>               copy <span class="op">=</span> <span class="va">VAR</span>, by <span class="op">=</span> <span class="va">LABEL</span>,</span>
<span>               options <span class="op">=</span> <span class="va">noname</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">sex_block</span></span>
<span></span>
<span></span>
<span><span class="co"># Race block --------------------------------------------------------------</span></span>
<span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create frequency counts for RACE"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get race frequency counts"</span><span class="op">)</span></span>
<span><span class="fu">proc_freq</span><span class="op">(</span><span class="va">datdm</span>, tables <span class="op">=</span> <span class="va">RACEF</span>,</span>
<span>          by <span class="op">=</span> <span class="va">ARM</span>,</span>
<span>          options <span class="op">=</span> <span class="va">nonobs</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">race_freq</span> </span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Combine counts and percents."</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">race_freq</span>, </span>
<span>         format <span class="op">=</span> <span class="va">fc</span>, </span>
<span>         rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>CAT <span class="op">=</span> <span class="st">"LABEL"</span><span class="op">)</span>,</span>
<span>         drop <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">PCT</span><span class="op">)</span>, </span>
<span>         <span class="op">{</span></span>
<span>           </span>
<span>           <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">PCT</span><span class="op">)</span></span>
<span>           </span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">race_comb</span> </span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Transpose ARMs into columns"</span><span class="op">)</span></span>
<span><span class="fu">proc_transpose</span><span class="op">(</span><span class="va">race_comb</span>, id <span class="op">=</span> <span class="va">BY</span>, var <span class="op">=</span> <span class="va">CNTPCT</span>,</span>
<span>               copy <span class="op">=</span> <span class="va">VAR</span>, by <span class="op">=</span> <span class="va">LABEL</span>, </span>
<span>               options <span class="op">=</span> <span class="va">noname</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">race_block</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Ethnic Block ---------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create frequency counts for ETHNIC"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Get ethnic frequency counts"</span><span class="op">)</span></span>
<span><span class="fu">proc_freq</span><span class="op">(</span><span class="va">datdm</span>, tables <span class="op">=</span> <span class="va">ETHNICF</span>,</span>
<span>          by <span class="op">=</span> <span class="va">ARM</span>,</span>
<span>          options <span class="op">=</span> <span class="va">nonobs</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ethnic_freq</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Combine counts and percents."</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">ethnic_freq</span>, format <span class="op">=</span> <span class="va">fc</span>, </span>
<span>         rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>CAT <span class="op">=</span> <span class="st">"LABEL"</span><span class="op">)</span>,</span>
<span>         drop <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">PCT</span><span class="op">)</span>, </span>
<span>         <span class="op">{</span></span>
<span>           <span class="va">CNTPCT</span> <span class="op">&lt;-</span> <span class="fu">fapply2</span><span class="op">(</span><span class="va">CNT</span>, <span class="va">PCT</span><span class="op">)</span></span>
<span>         <span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ethnic_comb</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Transpose ARMs into columns"</span><span class="op">)</span></span>
<span><span class="fu">proc_transpose</span><span class="op">(</span><span class="va">ethnic_comb</span>, id <span class="op">=</span> <span class="va">BY</span>, </span>
<span>               var <span class="op">=</span> <span class="va">CNTPCT</span>,</span>
<span>               copy <span class="op">=</span> <span class="va">VAR</span>, by <span class="op">=</span> <span class="va">LABEL</span>,</span>
<span>               options <span class="op">=</span> <span class="va">noname</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ethnic_block</span></span>
<span></span>
<span></span>
<span><span class="co"># Prepare final dataset ---------------------------------------------------</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Combine blocks into final data frame"</span><span class="op">)</span></span>
<span><span class="fu">datastep</span><span class="op">(</span><span class="va">age_block</span>, </span>
<span>         set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ageg_block</span>, <span class="va">sex_block</span>, <span class="va">race_block</span>, <span class="va">ethnic_block</span><span class="op">)</span>,</span>
<span>         <span class="op">{</span><span class="op">}</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">final</span></span>
<span></span>
<span><span class="co"># Report ------------------------------------------------------------------</span></span>
<span></span>
<span></span>
<span><span class="va">var_fmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span> <span class="op">=</span> <span class="st">"Age"</span>, <span class="st">"AGECAT"</span> <span class="op">=</span> <span class="st">"Age Group"</span>, <span class="st">"SEXF"</span> <span class="op">=</span> <span class="st">"Sex"</span>, </span>
<span>             <span class="st">"RACEF"</span> <span class="op">=</span> <span class="st">"Race"</span>, <span class="st">"ETHNICF"</span> <span class="op">=</span> <span class="st">"Ethnicity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create and print stand-alone report"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create Table</span></span>
<span><span class="va">tbl1</span> <span class="op">&lt;-</span> <span class="fu">create_table</span><span class="op">(</span><span class="va">final</span>, first_row_blank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">column_defaults</span><span class="op">(</span>from <span class="op">=</span> <span class="va">`ARM A`</span>, to <span class="op">=</span> <span class="va">`ARM D`</span>, align <span class="op">=</span> <span class="st">"center"</span>, width <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">stub</span><span class="op">(</span>vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VAR"</span>, <span class="st">"LABEL"</span><span class="op">)</span>, <span class="st">"Variable"</span>, width <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">VAR</span>, blank_after <span class="op">=</span> <span class="cn">TRUE</span>, dedupe <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"Variable"</span>,</span>
<span>         format <span class="op">=</span> <span class="va">var_fmt</span>,label_row <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">LABEL</span>, indent <span class="op">=</span> <span class="fl">.25</span>, label <span class="op">=</span> <span class="st">"Demographic Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM A`</span>,  label <span class="op">=</span> <span class="st">"Placebo"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM A"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM B`</span>,  label <span class="op">=</span> <span class="st">"Drug 50mg"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM B"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM C`</span>,  label <span class="op">=</span> <span class="st">"Drug 100mg"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM C"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM D`</span>,  label <span class="op">=</span> <span class="st">"Competitor"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM D"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">titles</span><span class="op">(</span><span class="st">"Table 1.0"</span>, <span class="st">"Analysis of Demographic Characteristics"</span>, </span>
<span>         <span class="st">"Safety Population"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">footnotes</span><span class="op">(</span><span class="st">"Program: DM_Table.R"</span>,</span>
<span>            <span class="st">"NOTE: Denominator based on number of non-missing responses."</span>,</span>
<span>            valign <span class="op">=</span> <span class="st">"bottom"</span>, align <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">rpt1</span> <span class="op">&lt;-</span> <span class="fu">create_report</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example15s"</span><span class="op">)</span>, </span>
<span>                     output_type <span class="op">=</span> <span class="st">"PDF"</span>, </span>
<span>                     font <span class="op">=</span> <span class="st">"Courier"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">page_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sponsor: Company"</span>, <span class="st">"Study: ABC"</span><span class="op">)</span>, </span>
<span>              right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DRUG: XYZ"</span>, <span class="st">"LOCK DATE: 02FEB2024"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">set_margins</span><span class="op">(</span>top <span class="op">=</span> <span class="fl">1</span>, bottom <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">add_content</span><span class="op">(</span><span class="va">tbl1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">page_footer</span><span class="op">(</span><span class="st">"Date Produced: {Sys.Date()}"</span>, right <span class="op">=</span> <span class="st">"Page [pg] of [tpg]"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Write out the report"</span><span class="op">)</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">write_report</span><span class="op">(</span><span class="va">rpt1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Create and print intext report"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create Table</span></span>
<span><span class="va">tbl2</span> <span class="op">&lt;-</span> <span class="fu">create_table</span><span class="op">(</span><span class="va">final</span>, first_row_blank <span class="op">=</span> <span class="cn">TRUE</span>, continuous <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     borders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"top"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">6.5</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">column_defaults</span><span class="op">(</span>from <span class="op">=</span> <span class="va">`ARM A`</span>, to <span class="op">=</span> <span class="va">`ARM D`</span>, align <span class="op">=</span> <span class="st">"center"</span>, width <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">stub</span><span class="op">(</span>vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VAR"</span>, <span class="st">"LABEL"</span><span class="op">)</span>, <span class="st">"Variable"</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">VAR</span>, blank_after <span class="op">=</span> <span class="cn">TRUE</span>, dedupe <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"Variable"</span>,</span>
<span>         format <span class="op">=</span> <span class="va">var_fmt</span>,label_row <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">LABEL</span>, indent <span class="op">=</span> <span class="fl">.25</span>, label <span class="op">=</span> <span class="st">"Demographic Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM A`</span>,  label <span class="op">=</span> <span class="st">"Placebo"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM A"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM B`</span>,  label <span class="op">=</span> <span class="st">"Drug 50mg"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM B"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM C`</span>,  label <span class="op">=</span> <span class="st">"Drug 100mg"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM C"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">define</span><span class="op">(</span><span class="va">`ARM D`</span>,  label <span class="op">=</span> <span class="st">"Competitor"</span>, n <span class="op">=</span> <span class="va">arm_pop</span><span class="op">[</span><span class="st">"ARM D"</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span></span>
<span>  <span class="fu">footnotes</span><span class="op">(</span><span class="st">"Program: DM_Table.R"</span>,</span>
<span>            <span class="st">"NOTE: Denominator based on number of non-missing responses."</span>,</span>
<span>            borders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"top"</span>, <span class="st">"bottom"</span><span class="op">)</span>, blank_row <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">rpt2</span> <span class="op">&lt;-</span> <span class="fu">create_report</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="st">"example15i"</span><span class="op">)</span>, </span>
<span>                     output_type <span class="op">=</span> <span class="st">"RTF"</span>, </span>
<span>                     font <span class="op">=</span> <span class="st">"Arial"</span>, orientation <span class="op">=</span> <span class="st">"landscape"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">set_margins</span><span class="op">(</span>top <span class="op">=</span> <span class="fl">1</span>, bottom <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu">add_content</span><span class="op">(</span><span class="va">tbl2</span><span class="op">)</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu">titles</span><span class="op">(</span><span class="st">"Table 1.0"</span>, <span class="st">"Analysis of Demographic Characteristics"</span>, </span>
<span>         <span class="st">"Safety Population"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Write out the report"</span><span class="op">)</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">write_report</span><span class="op">(</span><span class="va">rpt2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean Up ----------------------------------------------------------------</span></span>
<span><span class="fu">sep</span><span class="op">(</span><span class="st">"Clean Up"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">put</span><span class="op">(</span><span class="st">"Close log"</span><span class="op">)</span></span>
<span><span class="fu">log_close</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Uncomment to view report</span></span>
<span><span class="co"># file.show(res1$modified_path)</span></span>
<span></span>
<span><span class="co"># Uncomment to view report</span></span>
<span><span class="co"># file.show(res2$modified_path)</span></span>
<span></span>
<span><span class="co"># Uncomment to view log</span></span>
<span><span class="co"># file.show(lf)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>Here is the stand-alone report:</p>
<p><img src="../man/images/example15s1.png" align="center"><img src="../man/images/example15s2.png" align="center"></p>
<p>Here is the “intext” report:</p>
<p><img src="../man/images/example15i1.png" align="center"><img src="../man/images/example15i2.png" align="center"></p>
</div>
<div class="section level2">
<h2 id="log">Log<a class="anchor" aria-label="anchor" href="#log"></a>
</h2>
<p>And here is the log:</p>
<pre><code>=========================================================================
Log Path: C:/Users/dbosa/AppData/Local/Temp/RtmpiOUehg/log/example15.log
Program Path: C:/packages/Testing/sassytests/Intext.R
Working Directory: C:/packages/Testing
User Name: dbosa
R Version: 4.3.2 (2023-10-31 ucrt)
Machine: SOCRATES x86-64
Operating System: Windows 10 x64 build 22621
Base Packages: stats graphics grDevices utils datasets methods base 
Other Packages: tidylog_1.0.2 procs_1.0.5 reporter_1.4.4 libr_1.2.9 logr_1.3.5
fmtr_1.6.2 common_1.1.1 sassy_1.2.1
Log Start Time: 2024-02-03 13:05:46.15931
=========================================================================

=========================================================================
Prepare formats
=========================================================================

Age categories

# A user-defined format: 5 conditions
- as.factor: TRUE
  Name Type        Expression    Label Order
1  obj    U          is.na(x)  Missing     5
2  obj    U x &gt;= 18 &amp; x &lt;= 29 18 to 29     1
3  obj    U x &gt;= 30 &amp; x &lt;= 39 30 to 39     2
4  obj    U x &gt;= 40 &amp; x &lt;= 49 40 to 49     3
5  obj    U           x &gt;= 50    &gt;= 50     4

Sex decodes

# A user-defined format: 4 conditions
- as.factor: TRUE
  Name Type Expression   Label Order
1  obj    U   is.na(x) Missing     4
2  obj    U   x == "M"    Male     1
3  obj    U   x == "F"  Female     2
4  obj    U       TRUE   Other     3

Race decodes

# A user-defined format: 5 conditions
- as.factor: TRUE
  Name Type                       Expression                     Label Order
1  obj    U                         is.na(x)                   Missing     5
2  obj    U                     x == "WHITE"                     White     1
3  obj    U x == "BLACK OR AFRICAN AMERICAN" Black or African American     2
4  obj    U                     x == "ASIAN" Asian or Pacific Islander     3
5  obj    U                             TRUE                    Unkown     4

Ethnic decodes

# A user-defined format: 4 conditions
- as.factor: TRUE
  Name Type                    Expression                  Label Order
1  obj    U                      is.na(x)                Missing     4
2  obj    U     x == "HISPANIC OR LATINO"     Hispanic or Latino     1
3  obj    U x == "NOT HISPANIC OR LATINO" Not Hispanic or Latino     2
4  obj    U                x == "UNKNOWN"                Unknown     3

ARM decodes

# A user-defined format: 4 conditions
  Name Type   Expression      Label Order
1  obj    U x == "ARM A"    Placebo    NA
2  obj    U x == "ARM B"  Drug 10mg    NA
3  obj    U x == "ARM C"  Drug 20mg    NA
4  obj    U x == "ARM D" Competitor    NA

Compile format catalog

# A format catalog: 8 formats
- $MEAN: type S, "%.1f"
- $STD: type S, "(%.2f)"
- $Q1: type S, "%.1f"
- $Q3: type S, "%.1f"
- $MIN: type S, "%d"
- $MAX: type S, "%d"
- $CNT: type S, "%2d"
- $PCT: type S, "(%5.1f%%)"

=========================================================================
Prepare Data
=========================================================================

Open data library

# library 'sdtm': 7 items
- attributes: csv not loaded
- path: C:/Users/dbosa/AppData/Local/R/win-library/4.3/sassy/extdata
- items:
  Name Extension Rows Cols     Size        LastModified
1   AE       csv  150   27  88.5 Kb 2023-09-30 23:58:49
2   DM       csv   87   24  45.5 Kb 2023-09-30 23:58:49
3   DS       csv  174    9  34.1 Kb 2023-09-30 23:58:49
4   EX       csv   84   11  26.4 Kb 2023-09-30 23:58:49
5   IE       csv    2   14  13.4 Kb 2023-09-30 23:58:49
6   SV       csv  685   10  70.3 Kb 2023-09-30 23:58:49
7   VS       csv 3358   17 467.4 Kb 2023-09-30 23:58:49

Extract DM dataset

Apply formats

Get ARM population counts

proc_freq: input data set 85 rows and 29 columns
           tables: ARM
           output: long
           view: TRUE
           output: 1 datasets

# A tibble: 1 × 6
  VAR   STAT  `ARM A` `ARM B` `ARM C` `ARM D`
  &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 ARM   CNT        20      21      21      23

=========================================================================
Create summary statistics for age
=========================================================================

Call means procedure to get summary statistics for age

proc_means: input data set 85 rows and 29 columns
            by: ARM
            var: AGE
            stats: n mean std median q1 q3 min max
            view: TRUE
            output: 1 datasets

     BY VAR  N     MEAN      STD MEDIAN   Q1 Q3 MIN MAX
1 ARM A AGE 20 53.15000 11.89991   52.5 47.5 60  31  73
2 ARM B AGE 21 47.38095 16.25877   46.0 35.0 61  22  73
3 ARM C AGE 21 45.71429 14.41923   46.0 38.0 53  19  71
4 ARM D AGE 23 49.73913 14.32486   48.0 39.0 62  21  75

Combine stats

datastep: columns decreased from 10 to 7

     BY VAR  N    Mean (SD) Median     Q1 - Q3 Min - Max
1 ARM A AGE 20 53.1 (11.90)   52.5 47.5 - 60.0   31 - 73
2 ARM B AGE 21 47.4 (16.26)   46.0 35.0 - 61.0   22 - 73
3 ARM C AGE 21 45.7 (14.42)   46.0 38.0 - 53.0   19 - 71
4 ARM D AGE 23 49.7 (14.32)   48.0 39.0 - 62.0   21 - 75

Transpose ARMs into columns

proc_transpose: input data set 4 rows and 7 columns
                var: BY VAR N Mean (SD) Median Q1 - Q3 Min - Max
                id: BY
                copy: VAR
                name: LABEL
                output dataset 5 rows and 6 columns

  VAR     LABEL        ARM A        ARM B        ARM C        ARM D
1 AGE         N           20           21           21           23
2 AGE Mean (SD) 53.1 (11.90) 47.4 (16.26) 45.7 (14.42) 49.7 (14.32)
3 AGE    Median         52.5         46.0         46.0         48.0
4 AGE   Q1 - Q3  47.5 - 60.0  35.0 - 61.0  38.0 - 53.0  39.0 - 62.0
5 AGE Min - Max      31 - 73      22 - 73      19 - 71      21 - 75

=========================================================================
Create frequency counts for Age Group
=========================================================================

Get age group frequency counts

proc_freq: input data set 85 rows and 29 columns
           tables: AGECAT
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 20 × 5
   BY    VAR    CAT        CNT   PCT
   &lt;chr&gt; &lt;chr&gt;  &lt;ord&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1 ARM A AGECAT 18 to 29     0  0   
 2 ARM A AGECAT 30 to 39     3 15   
 3 ARM A AGECAT 40 to 49     5 25   
 4 ARM A AGECAT &gt;= 50       12 60   
 5 ARM A AGECAT Missing      0  0   
 6 ARM B AGECAT 18 to 29     3 14.3 
 7 ARM B AGECAT 30 to 39     4 19.0 
 8 ARM B AGECAT 40 to 49     6 28.6 
 9 ARM B AGECAT &gt;= 50        8 38.1 
10 ARM B AGECAT Missing      0  0   
11 ARM C AGECAT 18 to 29     3 14.3 
12 ARM C AGECAT 30 to 39     3 14.3 
13 ARM C AGECAT 40 to 49     7 33.3 
14 ARM C AGECAT &gt;= 50        8 38.1 
15 ARM C AGECAT Missing      0  0   
16 ARM D AGECAT 18 to 29     1  4.35
17 ARM D AGECAT 30 to 39     6 26.1 
18 ARM D AGECAT 40 to 49     5 21.7 
19 ARM D AGECAT &gt;= 50       11 47.8 
20 ARM D AGECAT Missing      0  0   

Combine counts and percents and assign age group factor for sorting

datastep: columns decreased from 5 to 4

# A tibble: 20 × 4
   VAR    LABEL    BY    CNTPCT       
   &lt;chr&gt;  &lt;ord&gt;    &lt;chr&gt; &lt;chr&gt;        
 1 AGECAT 18 to 29 ARM A " 0 (  0.0%)"
 2 AGECAT 30 to 39 ARM A " 3 ( 15.0%)"
 3 AGECAT 40 to 49 ARM A " 5 ( 25.0%)"
 4 AGECAT &gt;= 50    ARM A "12 ( 60.0%)"
 5 AGECAT Missing  ARM A " 0 (  0.0%)"
 6 AGECAT 18 to 29 ARM B " 3 ( 14.3%)"
 7 AGECAT 30 to 39 ARM B " 4 ( 19.0%)"
 8 AGECAT 40 to 49 ARM B " 6 ( 28.6%)"
 9 AGECAT &gt;= 50    ARM B " 8 ( 38.1%)"
10 AGECAT Missing  ARM B " 0 (  0.0%)"
11 AGECAT 18 to 29 ARM C " 3 ( 14.3%)"
12 AGECAT 30 to 39 ARM C " 3 ( 14.3%)"
13 AGECAT 40 to 49 ARM C " 7 ( 33.3%)"
14 AGECAT &gt;= 50    ARM C " 8 ( 38.1%)"
15 AGECAT Missing  ARM C " 0 (  0.0%)"
16 AGECAT 18 to 29 ARM D " 1 (  4.3%)"
17 AGECAT 30 to 39 ARM D " 6 ( 26.1%)"
18 AGECAT 40 to 49 ARM D " 5 ( 21.7%)"
19 AGECAT &gt;= 50    ARM D "11 ( 47.8%)"
20 AGECAT Missing  ARM D " 0 (  0.0%)"

Tranpose age group block

proc_transpose: input data set 20 rows and 4 columns
                by: LABEL
                var: CNTPCT
                id: BY
                copy: VAR
                name: NAME
                output dataset 5 rows and 6 columns

# A tibble: 5 × 6
  VAR    LABEL    `ARM A`       `ARM B`       `ARM C`       `ARM D`      
  &lt;chr&gt;  &lt;ord&gt;    &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;        
1 AGECAT 18 to 29 " 0 (  0.0%)" " 3 ( 14.3%)" " 3 ( 14.3%)" " 1 (  4.3%)"
2 AGECAT 30 to 39 " 3 ( 15.0%)" " 4 ( 19.0%)" " 3 ( 14.3%)" " 6 ( 26.1%)"
3 AGECAT 40 to 49 " 5 ( 25.0%)" " 6 ( 28.6%)" " 7 ( 33.3%)" " 5 ( 21.7%)"
4 AGECAT &gt;= 50    "12 ( 60.0%)" " 8 ( 38.1%)" " 8 ( 38.1%)" "11 ( 47.8%)"
5 AGECAT Missing  " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)"

=========================================================================
Create frequency counts for SEX
=========================================================================

Get sex frequency counts

proc_freq: input data set 85 rows and 29 columns
           tables: SEXF
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 16 × 5
   BY    VAR   CAT       CNT   PCT
   &lt;chr&gt; &lt;chr&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 ARM A SEXF  Male       15  75  
 2 ARM A SEXF  Female      5  25  
 3 ARM A SEXF  Other       0   0  
 4 ARM A SEXF  Missing     0   0  
 5 ARM B SEXF  Male       10  47.6
 6 ARM B SEXF  Female     11  52.4
 7 ARM B SEXF  Other       0   0  
 8 ARM B SEXF  Missing     0   0  
 9 ARM C SEXF  Male       12  57.1
10 ARM C SEXF  Female      9  42.9
11 ARM C SEXF  Other       0   0  
12 ARM C SEXF  Missing     0   0  
13 ARM D SEXF  Male       16  69.6
14 ARM D SEXF  Female      7  30.4
15 ARM D SEXF  Other       0   0  
16 ARM D SEXF  Missing     0   0  

Combine counts and percents.

datastep: columns decreased from 5 to 4

# A tibble: 16 × 4
   BY    VAR   LABEL   CNTPCT       
   &lt;chr&gt; &lt;chr&gt; &lt;ord&gt;   &lt;chr&gt;        
 1 ARM A SEXF  Male    "15 ( 75.0%)"
 2 ARM A SEXF  Female  " 5 ( 25.0%)"
 3 ARM A SEXF  Other   " 0 (  0.0%)"
 4 ARM A SEXF  Missing " 0 (  0.0%)"
 5 ARM B SEXF  Male    "10 ( 47.6%)"
 6 ARM B SEXF  Female  "11 ( 52.4%)"
 7 ARM B SEXF  Other   " 0 (  0.0%)"
 8 ARM B SEXF  Missing " 0 (  0.0%)"
 9 ARM C SEXF  Male    "12 ( 57.1%)"
10 ARM C SEXF  Female  " 9 ( 42.9%)"
11 ARM C SEXF  Other   " 0 (  0.0%)"
12 ARM C SEXF  Missing " 0 (  0.0%)"
13 ARM D SEXF  Male    "16 ( 69.6%)"
14 ARM D SEXF  Female  " 7 ( 30.4%)"
15 ARM D SEXF  Other   " 0 (  0.0%)"
16 ARM D SEXF  Missing " 0 (  0.0%)"

Transpose ARMs into columns

proc_transpose: input data set 16 rows and 4 columns
                by: LABEL
                var: CNTPCT
                id: BY
                copy: VAR
                name: NAME
                output dataset 4 rows and 6 columns

# A tibble: 4 × 6
  VAR   LABEL   `ARM A`       `ARM B`       `ARM C`       `ARM D`      
  &lt;chr&gt; &lt;ord&gt;   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;        
1 SEXF  Male    "15 ( 75.0%)" "10 ( 47.6%)" "12 ( 57.1%)" "16 ( 69.6%)"
2 SEXF  Female  " 5 ( 25.0%)" "11 ( 52.4%)" " 9 ( 42.9%)" " 7 ( 30.4%)"
3 SEXF  Other   " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)"
4 SEXF  Missing " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)"

=========================================================================
Create frequency counts for RACE
=========================================================================

Get race frequency counts

proc_freq: input data set 85 rows and 29 columns
           tables: RACEF
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 20 × 5
   BY    VAR   CAT                         CNT   PCT
   &lt;chr&gt; &lt;chr&gt; &lt;ord&gt;                     &lt;dbl&gt; &lt;dbl&gt;
 1 ARM A RACEF White                        19 95   
 2 ARM A RACEF Black or African American     1  5   
 3 ARM A RACEF Asian or Pacific Islander     0  0   
 4 ARM A RACEF Unkown                        0  0   
 5 ARM A RACEF Missing                       0  0   
 6 ARM B RACEF White                        18 85.7 
 7 ARM B RACEF Black or African American     1  4.76
 8 ARM B RACEF Asian or Pacific Islander     1  4.76
 9 ARM B RACEF Unkown                        1  4.76
10 ARM B RACEF Missing                       0  0   
11 ARM C RACEF White                        18 85.7 
12 ARM C RACEF Black or African American     3 14.3 
13 ARM C RACEF Asian or Pacific Islander     0  0   
14 ARM C RACEF Unkown                        0  0   
15 ARM C RACEF Missing                       0  0   
16 ARM D RACEF White                        20 87.0 
17 ARM D RACEF Black or African American     1  4.35
18 ARM D RACEF Asian or Pacific Islander     1  4.35
19 ARM D RACEF Unkown                        1  4.35
20 ARM D RACEF Missing                       0  0   

Combine counts and percents.

datastep: columns decreased from 5 to 4

# A tibble: 20 × 4
   BY    VAR   LABEL                     CNTPCT       
   &lt;chr&gt; &lt;chr&gt; &lt;ord&gt;                     &lt;chr&gt;        
 1 ARM A RACEF White                     "19 ( 95.0%)"
 2 ARM A RACEF Black or African American " 1 (  5.0%)"
 3 ARM A RACEF Asian or Pacific Islander " 0 (  0.0%)"
 4 ARM A RACEF Unkown                    " 0 (  0.0%)"
 5 ARM A RACEF Missing                   " 0 (  0.0%)"
 6 ARM B RACEF White                     "18 ( 85.7%)"
 7 ARM B RACEF Black or African American " 1 (  4.8%)"
 8 ARM B RACEF Asian or Pacific Islander " 1 (  4.8%)"
 9 ARM B RACEF Unkown                    " 1 (  4.8%)"
10 ARM B RACEF Missing                   " 0 (  0.0%)"
11 ARM C RACEF White                     "18 ( 85.7%)"
12 ARM C RACEF Black or African American " 3 ( 14.3%)"
13 ARM C RACEF Asian or Pacific Islander " 0 (  0.0%)"
14 ARM C RACEF Unkown                    " 0 (  0.0%)"
15 ARM C RACEF Missing                   " 0 (  0.0%)"
16 ARM D RACEF White                     "20 ( 87.0%)"
17 ARM D RACEF Black or African American " 1 (  4.3%)"
18 ARM D RACEF Asian or Pacific Islander " 1 (  4.3%)"
19 ARM D RACEF Unkown                    " 1 (  4.3%)"
20 ARM D RACEF Missing                   " 0 (  0.0%)"

Transpose ARMs into columns

proc_transpose: input data set 20 rows and 4 columns
                by: LABEL
                var: CNTPCT
                id: BY
                copy: VAR
                name: NAME
                output dataset 5 rows and 6 columns

# A tibble: 5 × 6
  VAR   LABEL                     `ARM A`       `ARM B`       `ARM C`       `ARM D`      
  &lt;chr&gt; &lt;ord&gt;                     &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;        
1 RACEF White                     "19 ( 95.0%)" "18 ( 85.7%)" "18 ( 85.7%)" "20 ( 87.0%)"
2 RACEF Black or African American " 1 (  5.0%)" " 1 (  4.8%)" " 3 ( 14.3%)" " 1 (  4.3%)"
3 RACEF Asian or Pacific Islander " 0 (  0.0%)" " 1 (  4.8%)" " 0 (  0.0%)" " 1 (  4.3%)"
4 RACEF Unkown                    " 0 (  0.0%)" " 1 (  4.8%)" " 0 (  0.0%)" " 1 (  4.3%)"
5 RACEF Missing                   " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)"

=========================================================================
Create frequency counts for ETHNIC
=========================================================================

Get ethnic frequency counts

proc_freq: input data set 85 rows and 29 columns
           tables: ETHNICF
           by: ARM
           view: TRUE
           output: 1 datasets

# A tibble: 16 × 5
   BY    VAR     CAT                      CNT    PCT
   &lt;chr&gt; &lt;chr&gt;   &lt;ord&gt;                  &lt;dbl&gt;  &lt;dbl&gt;
 1 ARM A ETHNICF Hispanic or Latino         0   0   
 2 ARM A ETHNICF Not Hispanic or Latino    20 100   
 3 ARM A ETHNICF Unknown                    0   0   
 4 ARM A ETHNICF Missing                    0   0   
 5 ARM B ETHNICF Hispanic or Latino         1   4.76
 6 ARM B ETHNICF Not Hispanic or Latino    19  90.5 
 7 ARM B ETHNICF Unknown                    1   4.76
 8 ARM B ETHNICF Missing                    0   0   
 9 ARM C ETHNICF Hispanic or Latino         2   9.52
10 ARM C ETHNICF Not Hispanic or Latino    17  81.0 
11 ARM C ETHNICF Unknown                    2   9.52
12 ARM C ETHNICF Missing                    0   0   
13 ARM D ETHNICF Hispanic or Latino         2   8.70
14 ARM D ETHNICF Not Hispanic or Latino    20  87.0 
15 ARM D ETHNICF Unknown                    1   4.35
16 ARM D ETHNICF Missing                    0   0   

Combine counts and percents.

datastep: columns decreased from 5 to 4

# A tibble: 16 × 4
   BY    VAR     LABEL                  CNTPCT       
   &lt;chr&gt; &lt;chr&gt;   &lt;ord&gt;                  &lt;chr&gt;        
 1 ARM A ETHNICF Hispanic or Latino     " 0 (  0.0%)"
 2 ARM A ETHNICF Not Hispanic or Latino "20 (100.0%)"
 3 ARM A ETHNICF Unknown                " 0 (  0.0%)"
 4 ARM A ETHNICF Missing                " 0 (  0.0%)"
 5 ARM B ETHNICF Hispanic or Latino     " 1 (  4.8%)"
 6 ARM B ETHNICF Not Hispanic or Latino "19 ( 90.5%)"
 7 ARM B ETHNICF Unknown                " 1 (  4.8%)"
 8 ARM B ETHNICF Missing                " 0 (  0.0%)"
 9 ARM C ETHNICF Hispanic or Latino     " 2 (  9.5%)"
10 ARM C ETHNICF Not Hispanic or Latino "17 ( 81.0%)"
11 ARM C ETHNICF Unknown                " 2 (  9.5%)"
12 ARM C ETHNICF Missing                " 0 (  0.0%)"
13 ARM D ETHNICF Hispanic or Latino     " 2 (  8.7%)"
14 ARM D ETHNICF Not Hispanic or Latino "20 ( 87.0%)"
15 ARM D ETHNICF Unknown                " 1 (  4.3%)"
16 ARM D ETHNICF Missing                " 0 (  0.0%)"

Transpose ARMs into columns

proc_transpose: input data set 16 rows and 4 columns
                by: LABEL
                var: CNTPCT
                id: BY
                copy: VAR
                name: NAME
                output dataset 4 rows and 6 columns

# A tibble: 4 × 6
  VAR     LABEL                  `ARM A`       `ARM B`       `ARM C`       `ARM D`      
  &lt;chr&gt;   &lt;ord&gt;                  &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;        
1 ETHNICF Hispanic or Latino     " 0 (  0.0%)" " 1 (  4.8%)" " 2 (  9.5%)" " 2 (  8.7%)"
2 ETHNICF Not Hispanic or Latino "20 (100.0%)" "19 ( 90.5%)" "17 ( 81.0%)" "20 ( 87.0%)"
3 ETHNICF Unknown                " 0 (  0.0%)" " 1 (  4.8%)" " 2 (  9.5%)" " 1 (  4.3%)"
4 ETHNICF Missing                " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)" " 0 (  0.0%)"

Combine blocks into final data frame

datastep: columns started with 6 and ended with 6

       VAR                     LABEL        ARM A        ARM B        ARM C        ARM D
1      AGE                         N           20           21           21           23
2      AGE                 Mean (SD) 53.1 (11.90) 47.4 (16.26) 45.7 (14.42) 49.7 (14.32)
3      AGE                    Median         52.5         46.0         46.0         48.0
4      AGE                   Q1 - Q3  47.5 - 60.0  35.0 - 61.0  38.0 - 53.0  39.0 - 62.0
5      AGE                 Min - Max      31 - 73      22 - 73      19 - 71      21 - 75
6   AGECAT                  18 to 29   0 (  0.0%)   3 ( 14.3%)   3 ( 14.3%)   1 (  4.3%)
7   AGECAT                  30 to 39   3 ( 15.0%)   4 ( 19.0%)   3 ( 14.3%)   6 ( 26.1%)
8   AGECAT                  40 to 49   5 ( 25.0%)   6 ( 28.6%)   7 ( 33.3%)   5 ( 21.7%)
9   AGECAT                     &gt;= 50  12 ( 60.0%)   8 ( 38.1%)   8 ( 38.1%)  11 ( 47.8%)
10  AGECAT                   Missing   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)
11    SEXF                      Male  15 ( 75.0%)  10 ( 47.6%)  12 ( 57.1%)  16 ( 69.6%)
12    SEXF                    Female   5 ( 25.0%)  11 ( 52.4%)   9 ( 42.9%)   7 ( 30.4%)
13    SEXF                     Other   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)
14    SEXF                   Missing   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)
15   RACEF                     White  19 ( 95.0%)  18 ( 85.7%)  18 ( 85.7%)  20 ( 87.0%)
16   RACEF Black or African American   1 (  5.0%)   1 (  4.8%)   3 ( 14.3%)   1 (  4.3%)
17   RACEF Asian or Pacific Islander   0 (  0.0%)   1 (  4.8%)   0 (  0.0%)   1 (  4.3%)
18   RACEF                    Unkown   0 (  0.0%)   1 (  4.8%)   0 (  0.0%)   1 (  4.3%)
19   RACEF                   Missing   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)
20 ETHNICF        Hispanic or Latino   0 (  0.0%)   1 (  4.8%)   2 (  9.5%)   2 (  8.7%)
21 ETHNICF    Not Hispanic or Latino  20 (100.0%)  19 ( 90.5%)  17 ( 81.0%)  20 ( 87.0%)
22 ETHNICF                   Unknown   0 (  0.0%)   1 (  4.8%)   2 (  9.5%)   1 (  4.3%)
23 ETHNICF                   Missing   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)   0 (  0.0%)

=========================================================================
Create and print stand-alone report
=========================================================================

Write out the report

# A report specification: 2 pages
- file_path: 'C:\Users\dbosa\AppData\Local\Temp\RtmpiOUehg/example15s.pdf'
- output_type: PDF
- units: inches
- orientation: landscape
- margins: top 1 bottom 1 left 1 right 1
- line size/count: 9/41
- page_header: left=Sponsor: Company, Study: ABC right=DRUG: XYZ, LOCK DATE: 02FEB2024
- page_footer: left=Date Produced: 2024-02-03 center= right=Page [pg] of [tpg]
- content: 
# A table specification:
- data: data.frame 'final' 23 rows 6 cols
- show_cols: all
- use_attributes: all
- title 1: 'Table 1.0'
- title 2: 'Analysis of Demographic Characteristics'
- title 3: 'Safety Population'
- footnote 1: 'Program: DM_Table.R'
- footnote 2: 'NOTE: Denominator based on number of non-missing responses.'
- stub: VAR LABEL 'Variable' width=2.5 align='left' 
- define: VAR 'Variable' dedupe='TRUE' 
- define: LABEL 'Demographic Category' 
- define: ARM A 'Placebo' 
- define: ARM B 'Drug 50mg' 
- define: ARM C 'Drug 100mg' 
- define: ARM D 'Competitor' 

=========================================================================
Create and print intext report
=========================================================================

# A report specification: 2 pages
- file_path: 'C:\Users\dbosa\AppData\Local\Temp\RtmpiOUehg/example15i.rtf'
- output_type: RTF
- units: inches
- orientation: landscape
- margins: top 1 bottom 1 left 1 right 1
- line size/count: 9/36
- content: 
# A table specification:
- data: data.frame 'final' 23 rows 6 cols
- show_cols: all
- use_attributes: all
- width: 6.5
- footnote 1: 'Program: DM_Table.R'
- footnote 2: 'NOTE: Denominator based on number of non-missing responses.'
- stub: VAR LABEL 'Variable' align='left' 
- define: VAR 'Variable' dedupe='TRUE' 
- define: LABEL 'Demographic Category' 
- define: ARM A 'Placebo' 
- define: ARM B 'Drug 50mg' 
- define: ARM C 'Drug 100mg' 
- define: ARM D 'Competitor' 

=========================================================================
Clean Up
=========================================================================

Close log

=========================================================================
Log End Time: 2024-02-03 13:05:49.136026
Log Elapsed Time: 0 00:00:02
=========================================================================

</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
